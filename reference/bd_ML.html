<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Maximization of the loglikelihood under the diversity-independent, possibly time-dependent diversification model — bd_ML • DDD</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Maximization of the loglikelihood under the diversity-independent, possibly time-dependent diversification model — bd_ML"><meta name="description" content="This function computes the maximum likelihood estimates of the parameters of
a diversity-independent diversification model for a given set of
phylogenetic branching times.  It also outputs the corresponding
loglikelihood that can be used in model comparisons."><meta property="og:description" content="This function computes the maximum likelihood estimates of the parameters of
a diversity-independent diversification model for a given set of
phylogenetic branching times.  It also outputs the corresponding
loglikelihood that can be used in model comparisons."></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">DDD</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">5.2.3</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Maximization of the loglikelihood under the diversity-independent, possibly time-dependent diversification model</h1>

      <div class="d-none name"><code>bd_ML.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>This function computes the maximum likelihood estimates of the parameters of
a diversity-independent diversification model for a given set of
phylogenetic branching times.  It also outputs the corresponding
loglikelihood that can be used in model comparisons.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">bd_ML</span><span class="op">(</span></span>
<span>  <span class="va">brts</span>,</span>
<span>  initparsopt <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.1</span>, <span class="fl">0.05</span> <span class="op">*</span> <span class="op">(</span><span class="va">tdmodel</span> <span class="op">&lt;=</span> <span class="fl">1</span><span class="op">)</span> <span class="op">+</span> <span class="fl">10</span> <span class="op">*</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">brts</span><span class="op">)</span> <span class="op">+</span> <span class="va">missnumspec</span><span class="op">)</span> <span class="op">*</span></span>
<span>    <span class="op">(</span><span class="va">tdmodel</span> <span class="op">&gt;</span> <span class="fl">1</span><span class="op">)</span><span class="op">)</span>,</span>
<span>  idparsopt <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">2</span> <span class="op">+</span> <span class="op">(</span><span class="va">tdmodel</span> <span class="op">&gt;</span> <span class="fl">1</span><span class="op">)</span><span class="op">)</span>,</span>
<span>  idparsfix <span class="op">=</span> <span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">4</span><span class="op">)</span><span class="op">[</span><span class="op">-</span><span class="va">idparsopt</span><span class="op">]</span>,</span>
<span>  parsfix <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">4</span><span class="op">)</span><span class="op">[</span><span class="va">idparsfix</span><span class="op">]</span>,</span>
<span>  missnumspec <span class="op">=</span> <span class="fl">0</span>,</span>
<span>  tdmodel <span class="op">=</span> <span class="fl">0</span>,</span>
<span>  cond <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  btorph <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  soc <span class="op">=</span> <span class="fl">2</span>,</span>
<span>  tol <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.001</span>, <span class="fl">1e-04</span>, <span class="fl">1e-06</span><span class="op">)</span>,</span>
<span>  maxiter <span class="op">=</span> <span class="fl">1000</span> <span class="op">*</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="op">(</span><span class="fl">1.25</span><span class="op">)</span><span class="op">^</span><span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">idparsopt</span><span class="op">)</span><span class="op">)</span>,</span>
<span>  changeloglikifnoconv <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  optimmethod <span class="op">=</span> <span class="st">"subplex"</span>,</span>
<span>  num_cycles <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  methode <span class="op">=</span> <span class="st">"odeint::runge_kutta_cash_karp54"</span>,</span>
<span>  verbose <span class="op">=</span> <span class="cn">FALSE</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-brts">brts<a class="anchor" aria-label="anchor" href="#arg-brts"></a></dt>
<dd><p>A set of branching times of a phylogeny, all positive</p></dd>


<dt id="arg-initparsopt">initparsopt<a class="anchor" aria-label="anchor" href="#arg-initparsopt"></a></dt>
<dd><p>The initial values of the parameters that must be
optimized</p></dd>


<dt id="arg-idparsopt">idparsopt<a class="anchor" aria-label="anchor" href="#arg-idparsopt"></a></dt>
<dd><p>The ids of the parameters that must be optimized, e.g. 1:3
for intrinsic speciation rate, extinction rate and carrying capacity.  The
ids are defined as follows: <br> id == 1 corresponds to lambda0 (speciation
rate) <br> id == 2 corresponds to mu0 (extinction rate) <br> id == 3
corresponds to lamda1 (parameter controlling decline in speciation rate with
time) <br> id == 4 corresponds to mu1 (parameter controlling decline in
extinction rate with time)</p></dd>


<dt id="arg-idparsfix">idparsfix<a class="anchor" aria-label="anchor" href="#arg-idparsfix"></a></dt>
<dd><p>The ids of the parameters that should not be optimized,
e.g. c(1,3) if lambda0 and lambda1 should not be optimized, but only mu0 and
mu1. In that case idparsopt must be c(2,4). The default is to fix all
parameters not specified in idparsopt.</p></dd>


<dt id="arg-parsfix">parsfix<a class="anchor" aria-label="anchor" href="#arg-parsfix"></a></dt>
<dd><p>The values of the parameters that should not be optimized</p></dd>


<dt id="arg-missnumspec">missnumspec<a class="anchor" aria-label="anchor" href="#arg-missnumspec"></a></dt>
<dd><p>The number of species that are in the clade but missing
in the phylogeny</p></dd>


<dt id="arg-tdmodel">tdmodel<a class="anchor" aria-label="anchor" href="#arg-tdmodel"></a></dt>
<dd><p>Sets the model of time-dependence: <br>
tdmodel == 0 : constant speciation and extinction rates <br>
tdmodel == 1 : speciation and/or extinction rate is exponentially declining
with time <br>
tdmodel == 2 : stepwise decline in speciation rate as in diversity-dependence
without extinction <br>
tdmodel == 3 : decline in speciation rate following deterministic logistic
equation for ddmodel = 1 <br>
tdmodel == 4 : decline in speciation rate such that the expected number of species matches with
that of ddmodel = 1 with the same mu</p></dd>


<dt id="arg-cond">cond<a class="anchor" aria-label="anchor" href="#arg-cond"></a></dt>
<dd><p>Conditioning: <br>
cond == 0 : conditioning on stem or crown age <br>
cond == 1 : conditioning on stem or crown age and non-extinction of the
phylogeny <br>
cond == 2 : conditioning on stem or crown age and on the total
number of extant taxa (including missing species) <br>
cond == 3 : conditioning on the total number of extant taxa (including missing species)</p></dd>


<dt id="arg-btorph">btorph<a class="anchor" aria-label="anchor" href="#arg-btorph"></a></dt>
<dd><p>Sets whether the likelihood is for the branching times (0) or
the phylogeny (1)</p></dd>


<dt id="arg-soc">soc<a class="anchor" aria-label="anchor" href="#arg-soc"></a></dt>
<dd><p>Sets whether stem or crown age should be used (1 or 2)</p></dd>


<dt id="arg-tol">tol<a class="anchor" aria-label="anchor" href="#arg-tol"></a></dt>
<dd><p>Sets the tolerances in the optimization. Consists of: <br>
reltolx = relative tolerance of parameter values in optimization <br>
reltolf = relative tolerance of function value in optimization <br>
abstolx = absolute tolerance of parameter values in optimization</p></dd>


<dt id="arg-maxiter">maxiter<a class="anchor" aria-label="anchor" href="#arg-maxiter"></a></dt>
<dd><p>Sets the maximum number of iterations in the optimization</p></dd>


<dt id="arg-changeloglikifnoconv">changeloglikifnoconv<a class="anchor" aria-label="anchor" href="#arg-changeloglikifnoconv"></a></dt>
<dd><p>if TRUE the loglik will be set to -Inf if ML
does not converge</p></dd>


<dt id="arg-optimmethod">optimmethod<a class="anchor" aria-label="anchor" href="#arg-optimmethod"></a></dt>
<dd><p>Method used in optimization of the likelihood. Current
default is 'subplex'. Alternative is 'simplex' (default of previous
versions)</p></dd>


<dt id="arg-num-cycles">num_cycles<a class="anchor" aria-label="anchor" href="#arg-num-cycles"></a></dt>
<dd><p>the number of cycles of opimization. If set at Inf, it will
do as many cycles as needed to meet the tolerance set for the target function.</p></dd>


<dt id="arg-methode">methode<a class="anchor" aria-label="anchor" href="#arg-methode"></a></dt>
<dd><p>The method used to solve the master equation under tdmodel =
4, default is 'odeint::runge_kutta_cash_karp54'.</p></dd>


<dt id="arg-verbose">verbose<a class="anchor" aria-label="anchor" href="#arg-verbose"></a></dt>
<dd><p>Show the parameters and loglikelihood for every call to the
loglik function</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>A dataframe with the following elements:<br></p>
<dl><dt>lambda0</dt>
<dd><p>gives the maximum likelihood estimate of lambda0</p></dd>

<dt>mu0</dt>
<dd><p>gives the maximum likelihood estimate of mu0</p></dd>

<dt>lambda1</dt>
<dd><p>gives the maximum likelihood estimate of lambda1</p></dd>

<dt>mu1</dt>
<dd><p>gives the
maximum likelihood estimate of mu1</p></dd>

<dt>loglik</dt>
<dd><p>gives the maximum
loglikelihood</p></dd>

<dt>df</dt>
<dd><p>gives the number of estimated parameters, i.e.
degrees of feedom</p></dd>

<dt>conv</dt>
<dd><p>gives a message on convergence of optimization; conv = 0 means
convergence</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>The output is a dataframe containing estimated parameters and maximum
loglikelihood. The computed loglikelihood contains the factor q! m! / (q +
m)! where q is the number of species in the phylogeny and m is the number of
missing species, as explained in the supplementary material to Etienne et
al. 2012.</p>
    </div>
    <div class="section level2">
    <h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a></h2>
    <p>- Etienne, R.S. et al. 2012, Proc. Roy. Soc. B 279: 1300-1309,
doi: 10.1098/rspb.2011.1439 <br> - Etienne, R.S. &amp; B. Haegeman 2012. Am. Nat.
180: E75-E89, doi: 10.1086/667574</p>
    </div>
    <div class="section level2">
    <h2 id="see-also">See also<a class="anchor" aria-label="anchor" href="#see-also"></a></h2>
    <div class="dont-index"><p><code><a href="bd_loglik.html">bd_loglik</a></code></p></div>
    </div>
    <div class="section level2">
    <h2 id="author">Author<a class="anchor" aria-label="anchor" href="#author"></a></h2>
    <p>Rampal S. Etienne &amp; Bart Haegeman</p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"Estimating parameters for a set of branching times brts with the default settings:"</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Estimating parameters for a set of branching times brts with the default settings:</span>
<span class="r-in"><span><span class="va">brts</span> <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="fl">20</span></span></span>
<span class="r-in"><span><span class="fu">bd_ML</span><span class="op">(</span>brts <span class="op">=</span> <span class="va">brts</span>, cond <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> You are optimizing lambda0 mu0 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> You are fixing lambda1 mu1 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Optimizing the likelihood - this may take a while. </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> The loglikelihood for the initial parameter values is -67.8956450330451.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Maximum likelihood parameter estimates: lambda0: 0.082413, mu0: 0.000012, lambda1: 0.000000, mu1: 0.000000: </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Maximum loglikelihood: -66.379536</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>      lambda0          mu0 lambda1 mu1    loglik df conv</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1 0.08241342 1.162588e-05       0   0 -66.37954  2    0</span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Rampal S. Etienne, Bart Haegeman.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

    </footer></div>





  </body></html>

