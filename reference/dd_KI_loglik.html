<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Loglikelihood for diversity-dependent diversification models with decoupling of a subclade from a main clade at time t = t_d — dd_KI_loglik • DDD</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Loglikelihood for diversity-dependent diversification models with decoupling of a subclade from a main clade at time t = t_d — dd_KI_loglik"><meta name="description" content="This function computes loglikelihood of a diversity-dependent
diversification model for a given set of branching times and parameter
values where the diversity-dependent dynamics of a subclade decouple from
the dynamics of the main clade at time t_d, potentially accompanied by a
shift in parameters."><meta property="og:description" content="This function computes loglikelihood of a diversity-dependent
diversification model for a given set of branching times and parameter
values where the diversity-dependent dynamics of a subclade decouple from
the dynamics of the main clade at time t_d, potentially accompanied by a
shift in parameters."></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">DDD</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">5.2.4</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Loglikelihood for diversity-dependent diversification models with decoupling of a subclade from a main clade at time t = t_d</h1>

      <div class="d-none name"><code>dd_KI_loglik.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>This function computes loglikelihood of a diversity-dependent
diversification model for a given set of branching times and parameter
values where the diversity-dependent dynamics of a subclade decouple from
the dynamics of the main clade at time t_d, potentially accompanied by a
shift in parameters.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">dd_KI_loglik</span><span class="op">(</span></span>
<span>  <span class="va">pars1</span>,</span>
<span>  <span class="va">pars2</span>,</span>
<span>  <span class="va">brtsM</span>,</span>
<span>  <span class="va">brtsS</span>,</span>
<span>  <span class="va">missnumspec</span>,</span>
<span>  methode <span class="op">=</span> <span class="st">"odeint::runge_kutta_cash_karp54"</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-pars-">pars1<a class="anchor" aria-label="anchor" href="#arg-pars-"></a></dt>
<dd><p>Vector of parameters: <br><br><code>pars1[1]</code> corresponds to
lambda_M (speciation rate) of the main clade <br><code>pars1[2]</code> corresponds
to mu_M (extinction rate) of the main clade <br><code>pars1[3]</code> corresponds
to K_M (clade-level carrying capacity) of the main clade <br><code>pars1[4]</code> corresponds to lambda_S (speciation rate) of the subclade <br><code>pars1[5]</code> corresponds to mu_S (extinction rate) of the subclade <br><code>pars1[6]</code> corresponds to K_S (clade-level carrying capacity) of the
subclade <br><code>pars1[7]</code> corresponds to t_d (the time of decoupling)</p></dd>


<dt id="arg-pars-">pars2<a class="anchor" aria-label="anchor" href="#arg-pars-"></a></dt>
<dd><p>Vector of model settings: <br><br><code>pars2[1]</code> sets the
maximum number of species for which a probability must be computed.  This
must be larger than 1 + missnumspec + length(brts). <br><br><code>pars2[2]</code> sets the model of diversity-dependence: <br>
- <code>pars2[2] == 1</code> linear
dependence in speciation rate with parameter K (= diversity where speciation
= extinction)<br>
- <code>pars2[2] == 1.3</code> linear dependence in speciation
rate with parameter K' (= diversity where speciation = 0)<br>
- <code>pars2[2] == 2</code> exponential dependence in speciation rate with
parameter K (= diversity where speciation = extinction)<br>
- <code>pars2[2] == 2.1</code> variant of exponential dependence in speciation rate with offset at
infinity<br>
- <code>pars2[2] == 2.2</code> 1/n dependence in speciation rate<br>
- <code>pars2[2] == 2.3</code> exponential dependence in speciation rate with
parameter x (= exponent)<br>
- <code>pars2[2] == 3</code> linear dependence in
extinction rate <br>
- <code>pars2[2] == 4</code> exponential dependence in
extinction rate <br>
- <code>pars2[2] == 4.1</code> variant of exponential
dependence in extinction rate with offset at infinity<br>
- <code>pars2[2] == 4.2</code> 1/n dependence in extinction rate<br><br><code>pars2[3]</code> sets the
conditioning: <br>
- <code>pars2[3] == 0</code> no conditioning (or just crown age) <br>
- <code>pars2[3] == 1</code> conditioning on non-extinction of the phylogeny <br>
- <code>pars2[3] == 2</code> conditioning on number of species and crown age;
not yet implemented <br>
- <code>pars2[3] == 3</code> conditioning on number of species only;
not yet implemented <br>
- <code>pars2[3] == 4</code> conditioning on survival of the subclade <br>
- <code>pars2[3] == 5</code> conditioning on survival of all subclades
and of both crown lineages in the main clade. This assumes that subclades
that have already shifted do not undergo another shift, i.e. shifts only
occur in the main clade. <br><br><code>pars2[4]</code> Obsolete. <br><br><code>pars2[5]</code> sets whether the parameters and likelihood should be
shown on screen (1) or not (0) <br><br><code>pars2[6]</code> sets whether the first data point is stem age (1) or crown age (2) <br><br><code>pars2[7]</code> sets whether the old (incorrect) likelihood should be used (0),
or whether the new corrected likelihood should be used (1).</p></dd>


<dt id="arg-brtsm">brtsM<a class="anchor" aria-label="anchor" href="#arg-brtsm"></a></dt>
<dd><p>A set of branching times of the main clade in the phylogeny,
all positive</p></dd>


<dt id="arg-brtss">brtsS<a class="anchor" aria-label="anchor" href="#arg-brtss"></a></dt>
<dd><p>A set of branching times of the subclade in the phylogeny, all
positive</p></dd>


<dt id="arg-missnumspec">missnumspec<a class="anchor" aria-label="anchor" href="#arg-missnumspec"></a></dt>
<dd><p>The number of species that are in the clade but missing
in the phylogeny. One can specify the sum of the missing species in main
clade and subclade or a vector c(missnumspec_M,missnumspec_S) with missing
species in main clade and subclade respectively.</p></dd>


<dt id="arg-methode">methode<a class="anchor" aria-label="anchor" href="#arg-methode"></a></dt>
<dd><p>The method used to solve the master equation, default is
'analytical' which uses matrix exponentiation; alternatively numerical ODE
solvers can be used, such as 'odeint::runge_kutta_cash_karp54'. These were used in the
package before version 3.1.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>The loglikelihood</p>
    </div>
    <div class="section level2">
    <h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a></h2>
    <p>- Etienne, R.S. et al. 2012, Proc. Roy. Soc. B 279: 1300-1309,
doi: 10.1098/rspb.2011.1439 <br> - Etienne, R.S. &amp; B. Haegeman 2012. Am. Nat.
180: E75-E89, doi: 10.1086/667574</p>
    </div>
    <div class="section level2">
    <h2 id="see-also">See also<a class="anchor" aria-label="anchor" href="#see-also"></a></h2>
    <div class="dont-index"><p><code><a href="dd_KI_ML.html">dd_KI_ML</a></code>, <code><a href="dd_loglik.html">dd_loglik</a></code>
<code><a href="dd_SR_loglik.html">dd_SR_loglik</a></code></p></div>
    </div>
    <div class="section level2">
    <h2 id="author">Author<a class="anchor" aria-label="anchor" href="#author"></a></h2>
    <p>Rampal S. Etienne &amp; Bart Haegeman</p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">pars1</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.25</span>,<span class="fl">0.12</span>,<span class="fl">25.51</span>,<span class="fl">1.0</span>,<span class="fl">0.16</span>,<span class="fl">8.61</span>,<span class="fl">9.8</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">pars2</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">200</span>,<span class="fl">1</span>,<span class="fl">0</span>,<span class="fl">18.8</span>,<span class="fl">1</span>,<span class="fl">2</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">missnumspec</span> <span class="op">=</span> <span class="fl">0</span></span></span>
<span class="r-in"><span><span class="va">brtsM</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">25.2</span>,<span class="fl">24.6</span>,<span class="fl">24.0</span>,<span class="fl">22.5</span>,<span class="fl">21.7</span>,<span class="fl">20.4</span>,<span class="fl">19.9</span>,<span class="fl">19.7</span>,<span class="fl">18.8</span>,<span class="fl">17.1</span>,<span class="fl">15.8</span>,<span class="fl">11.8</span>,<span class="fl">9.7</span>,<span class="fl">8.9</span>,<span class="fl">5.7</span>,<span class="fl">5.2</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">brtsS</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">9.6</span>,<span class="fl">8.6</span>,<span class="fl">7.4</span>,<span class="fl">4.9</span>,<span class="fl">2.5</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu">dd_KI_loglik</span><span class="op">(</span><span class="va">pars1</span>,<span class="va">pars2</span>,<span class="va">brtsM</span>,<span class="va">brtsS</span>,<span class="va">missnumspec</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Parameters: 0.250000 0.120000 25.510000 1.000000 0.160000 8.610000 9.800000, Loglikelihood: -77.815687</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] -77.81569</span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Rampal S. Etienne, Bart Haegeman.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.2.0.</p>
</div>

    </footer></div>





  </body></html>

