<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Loglikelihood for diversity-dependent diversification models with multiple decoupling (rate shift) events — dd_multiple_KI_loglik • DDD</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Loglikelihood for diversity-dependent diversification models with multiple decoupling (rate shift) events — dd_multiple_KI_loglik"><meta name="description" content="This function computes loglikelihood of a diversity-dependent
diversification model for a given set of branching times and parameter
values where the diversity-dependent dynamics of subclades decouple from
the dynamics of main clades, potentially accompanied by a
shift in parameters."><meta property="og:description" content="This function computes loglikelihood of a diversity-dependent
diversification model for a given set of branching times and parameter
values where the diversity-dependent dynamics of subclades decouple from
the dynamics of main clades, potentially accompanied by a
shift in parameters."></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">DDD</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">5.2.3</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Loglikelihood for diversity-dependent diversification models with multiple decoupling (rate shift) events</h1>

      <div class="d-none name"><code>dd_multiple_KI_loglik.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>This function computes loglikelihood of a diversity-dependent
diversification model for a given set of branching times and parameter
values where the diversity-dependent dynamics of subclades decouple from
the dynamics of main clades, potentially accompanied by a
shift in parameters.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">dd_multiple_KI_loglik</span><span class="op">(</span></span>
<span>  <span class="va">pars1_list</span>,</span>
<span>  <span class="va">pars2</span>,</span>
<span>  <span class="va">brts_k_list</span>,</span>
<span>  <span class="va">missnumspec_list</span>,</span>
<span>  reltol <span class="op">=</span> <span class="fl">1e-14</span>,</span>
<span>  abstol <span class="op">=</span> <span class="fl">1e-16</span>,</span>
<span>  methode <span class="op">=</span> <span class="st">"odeint::runge_kutta_cash_karp54"</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-pars-list">pars1_list<a class="anchor" aria-label="anchor" href="#arg-pars-list"></a></dt>
<dd><p>list of paramater sets one for each rate regime (subclade).
The parameters are: lambda (speciation rate), mu (extinction rate), and K
(clade-level carrying capacity).</p></dd>


<dt id="arg-pars-">pars2<a class="anchor" aria-label="anchor" href="#arg-pars-"></a></dt>
<dd><p>Vector of model settings: <br><br><code>pars2[1]</code> sets the
maximum number of species for which a probability must be computed.  This
must be larger than 1 + missnumspec + length(brts). <br><br><code>pars2[2]</code> sets the model of diversity-dependence: <br>
- <code>pars2[2] == 1</code> linear
dependence in speciation rate with parameter K (= diversity where speciation
= extinction)<br>
- <code>pars2[2] == 1.3</code> linear dependence in speciation
rate with parameter K' (= diversity where speciation = 0)<br>
- <code>pars2[2] == 2</code> exponential dependence in speciation rate with
parameter K (= diversity where speciation = extinction)<br>
- <code>pars2[2] == 2.1</code> variant of exponential dependence in speciation rate with offset at
infinity<br>
- <code>pars2[2] == 2.2</code> 1/n dependence in speciation rate<br>
- <code>pars2[2] == 2.3</code> exponential dependence in speciation rate with
parameter x (= exponent)<br>
- <code>pars2[2] == 3</code> linear dependence in
extinction rate <br>
- <code>pars2[2] == 4</code> exponential dependence in
extinction rate <br>
- <code>pars2[2] == 4.1</code> variant of exponential
dependence in extinction rate with offset at infinity<br>
- <code>pars2[2] == 4.2</code> 1/n dependence in extinction rate<br><br><code>pars2[3]</code> sets the
conditioning: <br>
- <code>pars2[3] == 0</code> no conditioning (or just crown age) <br>
- <code>pars2[3] == 1</code> conditioning on non-extinction of the phylogeny <br>
- <code>pars2[3] == 2</code> conditioning on number of species and crown age;
not yet implemented <br>
- <code>pars2[3] == 3</code> conditioning on number of species only;
not yet implemented <br>
- <code>pars2[3] == 4</code> conditioning on survival of the subclade <br>
- <code>pars2[3] == 5</code> conditioning on survival of all subclades
and of both crown lineages in the main clade. This assumes that subclades
that have already shifted do not undergo another shift, i.e. shifts only
occur in the main clade. <br><br><code>pars2[4]</code> Obsolete. <br><br><code>pars2[5]</code> sets whether the parameters and likelihood should be
shown on screen (1) or not (0) <br><br><code>pars2[6]</code> sets whether the first data point is stem age (1) or crown age (2) <br><br><code>pars2[7]</code> sets whether the old (incorrect) likelihood should be used (0),
or whether the new corrected likelihood should be used (1).</p></dd>


<dt id="arg-brts-k-list">brts_k_list<a class="anchor" aria-label="anchor" href="#arg-brts-k-list"></a></dt>
<dd><p>list of matrices, one for each rate regime (subclade). Each
matrix has in the first row the branching times including the shift/decoupling time
and the present time (0) in negative time (i.e. 10 mya = -10). In the second row
it has the number of lineages, i.e. starting at 2 for a phylogeny with a crown
and increasing by one at each branching time and decreasing by one at each
decoupling/shift time. The last element is the same as the second last.</p></dd>


<dt id="arg-missnumspec-list">missnumspec_list<a class="anchor" aria-label="anchor" href="#arg-missnumspec-list"></a></dt>
<dd><p>list containing the number of missing species for each clade.
If only a single number m of missing species is known for the entire phylogeny, then each
element of the list should be 0:m. One can also create this from m using the function
create_missnumspec_list</p></dd>


<dt id="arg-reltol">reltol<a class="anchor" aria-label="anchor" href="#arg-reltol"></a></dt>
<dd><p>relative tolerance in integration of the ODE system, default at 1e-14</p></dd>


<dt id="arg-abstol">abstol<a class="anchor" aria-label="anchor" href="#arg-abstol"></a></dt>
<dd><p>tolerance tolerance in integration of the ODE system, default at 1e-16</p></dd>


<dt id="arg-methode">methode<a class="anchor" aria-label="anchor" href="#arg-methode"></a></dt>
<dd><p>The method used to solve the master equation, default is
'analytical' which uses matrix exponentiation; alternatively numerical ODE
solvers can be used, such as 'odeint::runge_kutta_cash_karp54'. These were used in the
package before version 3.1.</p></dd>

</dl></div>

  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Rampal S. Etienne, Bart Haegeman.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

    </footer></div>





  </body></html>

