[{"path":"https://rsetienne.github.io/DDD/authors.html","id":null,"dir":"","previous_headings":"","what":"Authors","title":"Authors and Citation","text":"Rampal S. Etienne. Author, maintainer. Bart Haegeman. Author. Hanno Hildenbrandt. Contributor. Giovanni Laudanno. Contributor.","code":""},{"path":"https://rsetienne.github.io/DDD/authors.html","id":"citation","dir":"","previous_headings":"","what":"Citation","title":"Authors and Citation","text":"Etienne R, Haegeman B (2024). DDD: Diversity-Dependent Diversification. R package version 5.2.3, https://rsetienne.github.io/DDD/.","code":"@Manual{,   title = {DDD: Diversity-Dependent Diversification},   author = {Rampal S. Etienne and Bart Haegeman},   year = {2024},   note = {R package version 5.2.3},   url = {https://rsetienne.github.io/DDD/}, }"},{"path":"https://rsetienne.github.io/DDD/index.html","id":"ddd-diversity-dependent-diversification","dir":"","previous_headings":"","what":"Diversity-Dependent Diversification","title":"Diversity-Dependent Diversification","text":"Implements maximum likelihood bootstrap methods based diversity-dependent birth-death process test whether speciation extinction diversity-dependent, various models including various types key innovations. Also contains functions simulate diversity-dependent process.","code":""},{"path":[]},{"path":"https://rsetienne.github.io/DDD/index.html","id":"from-cran","dir":"","previous_headings":"Installing DDD","what":"From CRAN","title":"Diversity-Dependent Diversification","text":"within R, :","code":"install.packages(\"DDD\")"},{"path":"https://rsetienne.github.io/DDD/index.html","id":"from-github","dir":"","previous_headings":"Installing DDD","what":"From GitHub","title":"Diversity-Dependent Diversification","text":"Install DDD GitHub repository running:","code":"install.packages(\"remotes\") remotes::install_github(\"rsetienne/DDD\")"},{"path":"https://rsetienne.github.io/DDD/index.html","id":"references","dir":"","previous_headings":"","what":"References","title":"Diversity-Dependent Diversification","text":"Etienne et al. 2012, Proc. Roy. Soc. B 279: 1300-1309, https://doi.org/10.1098/rspb.2011.1439 Etienne & Haegeman 2012, . Nat. 180: E75-E89, https://doi.org/10.1086/667574 Etienne et al. 2016. Meth. Ecol. Evol. 7: 1092-1099, https://doi.org/10.1111/2041-210X.12565 Laudanno et al. 2021. Syst. Biol. 70: 389–407, https://doi.org/10.1093/sysbio/syaa048","code":""},{"path":"https://rsetienne.github.io/DDD/reference/DDD-package.html","id":null,"dir":"Reference","previous_headings":"","what":"DDD: Diversity-Dependent Diversification — DDD-package","title":"DDD: Diversity-Dependent Diversification — DDD-package","text":"Implements maximum likelihood bootstrap methods based diversity-dependent birth-death process test whether speciation extinction diversity-dependent, various models including various types key innovations. See Etienne et al. 2012, Proc. Roy. Soc. B 279: 1300-1309, doi:10.1098/rspb.2011.1439 , Etienne & Haegeman 2012, . Nat. 180: E75-E89, doi:10.1086/667574 , Etienne et al. 2016. Meth. Ecol. Evol. 7: 1092-1099, doi:10.1111/2041-210X.12565  Laudanno et al. 2021. Syst. Biol. 70: 389–407, doi:10.1093/sysbio/syaa048 . Also contains functions simulate diversity-dependent process.","code":""},{"path":[]},{"path":"https://rsetienne.github.io/DDD/reference/DDD-package.html","id":"author","dir":"Reference","previous_headings":"","what":"Author","title":"DDD: Diversity-Dependent Diversification — DDD-package","text":"Maintainer: Rampal S. Etienne r.s.etienne@rug.nl (ORCID) Authors: Bart Haegeman bart.haegeman@sete.cnrs.fr (ORCID) contributors: Hanno Hildenbrandt h.hildenbrandt@rug.nl (ORCID) [contributor] Giovanni Laudanno glaudanno@gmail.com (ORCID) [contributor]","code":""},{"path":"https://rsetienne.github.io/DDD/reference/L2brts.html","id":null,"dir":"Reference","previous_headings":"","what":"Function to convert a table with speciation and extinction events to a set of branching times — L2brts","title":"Function to convert a table with speciation and extinction events to a set of branching times — L2brts","text":"Converting table speciation extinction events set branching times","code":""},{"path":"https://rsetienne.github.io/DDD/reference/L2brts.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Function to convert a table with speciation and extinction events to a set of branching times — L2brts","text":"","code":"L2brts(L, dropextinct = T)"},{"path":"https://rsetienne.github.io/DDD/reference/L2brts.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Function to convert a table with speciation and extinction events to a set of branching times — L2brts","text":"L Matrix events produced dd_sim:  - first column time species born Mya - second column label parent species; positive negative values indicate whether species belongs left right crown lineage  - third column label daughter species ; positive negative values indicate whether species belongs left right crown lineage  - fourth column time extinction species; fourth element equals -1, species still extant. dropextinct Sets whether phylogeny drop species extinct present","code":""},{"path":"https://rsetienne.github.io/DDD/reference/L2brts.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Function to convert a table with speciation and extinction events to a set of branching times — L2brts","text":"brts set branching times","code":""},{"path":"https://rsetienne.github.io/DDD/reference/L2brts.html","id":"references","dir":"Reference","previous_headings":"","what":"References","title":"Function to convert a table with speciation and extinction events to a set of branching times — L2brts","text":"- Etienne, R.S. et al. 2012, Proc. Roy. Soc. B 279: 1300-1309, doi: 10.1098/rspb.2011.1439  - Etienne, R.S. & B. Haegeman 2012. . Nat. 180: E75-E89, doi: 10.1086/667574","code":""},{"path":"https://rsetienne.github.io/DDD/reference/L2brts.html","id":"author","dir":"Reference","previous_headings":"","what":"Author","title":"Function to convert a table with speciation and extinction events to a set of branching times — L2brts","text":"Rampal S. Etienne","code":""},{"path":"https://rsetienne.github.io/DDD/reference/L2brts.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Function to convert a table with speciation and extinction events to a set of branching times — L2brts","text":"","code":"sim = dd_sim(c(0.2,0.1,20),10) phy = L2brts(sim$L) plot(phy)"},{"path":"https://rsetienne.github.io/DDD/reference/L2phylo.html","id":null,"dir":"Reference","previous_headings":"","what":"Function to convert a table with speciation and extinction events to a phylogeny — L2phylo","title":"Function to convert a table with speciation and extinction events to a phylogeny — L2phylo","text":"Converting table speciation extinction events phylogeny","code":""},{"path":"https://rsetienne.github.io/DDD/reference/L2phylo.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Function to convert a table with speciation and extinction events to a phylogeny — L2phylo","text":"","code":"L2phylo(L, dropextinct = T)"},{"path":"https://rsetienne.github.io/DDD/reference/L2phylo.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Function to convert a table with speciation and extinction events to a phylogeny — L2phylo","text":"L Matrix events produced dd_sim:  - first column time species born Mya - second column label parent species; positive negative values indicate whether species belongs left right crown lineage  - third column label daughter species ; positive negative values indicate whether species belongs left right crown lineage  - fourth column time extinction species; fourth element equals -1, species still extant. dropextinct Sets whether phylogeny drop species extinct present","code":""},{"path":"https://rsetienne.github.io/DDD/reference/L2phylo.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Function to convert a table with speciation and extinction events to a phylogeny — L2phylo","text":"phy phylogeny phylo type","code":""},{"path":"https://rsetienne.github.io/DDD/reference/L2phylo.html","id":"references","dir":"Reference","previous_headings":"","what":"References","title":"Function to convert a table with speciation and extinction events to a phylogeny — L2phylo","text":"- Etienne, R.S. et al. 2012, Proc. Roy. Soc. B 279: 1300-1309, doi: 10.1098/rspb.2011.1439  - Etienne, R.S. & B. Haegeman 2012. . Nat. 180: E75-E89, doi: 10.1086/667574","code":""},{"path":"https://rsetienne.github.io/DDD/reference/L2phylo.html","id":"author","dir":"Reference","previous_headings":"","what":"Author","title":"Function to convert a table with speciation and extinction events to a phylogeny — L2phylo","text":"Rampal S. Etienne","code":""},{"path":"https://rsetienne.github.io/DDD/reference/L2phylo.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Function to convert a table with speciation and extinction events to a phylogeny — L2phylo","text":"","code":"sim = dd_sim(c(0.2,0.1,20),10) phy = L2phylo(sim$L) plot(phy)"},{"path":"https://rsetienne.github.io/DDD/reference/bd_ML.html","id":null,"dir":"Reference","previous_headings":"","what":"Maximization of the loglikelihood under the diversity-independent, possibly time-dependent diversification model — bd_ML","title":"Maximization of the loglikelihood under the diversity-independent, possibly time-dependent diversification model — bd_ML","text":"function computes maximum likelihood estimates parameters diversity-independent diversification model given set phylogenetic branching times.  also outputs corresponding loglikelihood can used model comparisons.","code":""},{"path":"https://rsetienne.github.io/DDD/reference/bd_ML.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Maximization of the loglikelihood under the diversity-independent, possibly time-dependent diversification model — bd_ML","text":"","code":"bd_ML(   brts,   initparsopt = c(0.1, 0.05 * (tdmodel <= 1) + 10 * (length(brts) + missnumspec) *     (tdmodel > 1)),   idparsopt = c(1, 2 + (tdmodel > 1)),   idparsfix = (1:4)[-idparsopt],   parsfix = rep(0, 4)[idparsfix],   missnumspec = 0,   tdmodel = 0,   cond = 1,   btorph = 1,   soc = 2,   tol = c(0.001, 1e-04, 1e-06),   maxiter = 1000 * round((1.25)^length(idparsopt)),   changeloglikifnoconv = FALSE,   optimmethod = \"subplex\",   num_cycles = 1,   methode = \"odeint::runge_kutta_cash_karp54\",   verbose = FALSE )"},{"path":"https://rsetienne.github.io/DDD/reference/bd_ML.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Maximization of the loglikelihood under the diversity-independent, possibly time-dependent diversification model — bd_ML","text":"brts set branching times phylogeny, positive initparsopt initial values parameters must optimized idparsopt ids parameters must optimized, e.g. 1:3 intrinsic speciation rate, extinction rate carrying capacity.  ids defined follows:  id == 1 corresponds lambda0 (speciation rate)  id == 2 corresponds mu0 (extinction rate)  id == 3 corresponds lamda1 (parameter controlling decline speciation rate time)  id == 4 corresponds mu1 (parameter controlling decline extinction rate time) idparsfix ids parameters optimized, e.g. c(1,3) lambda0 lambda1 optimized, mu0 mu1. case idparsopt must c(2,4). default fix parameters specified idparsopt. parsfix values parameters optimized missnumspec number species clade missing phylogeny tdmodel Sets model time-dependence:  tdmodel == 0 : constant speciation extinction rates  tdmodel == 1 : speciation /extinction rate exponentially declining time  tdmodel == 2 : stepwise decline speciation rate diversity-dependence without extinction  tdmodel == 3 : decline speciation rate following deterministic logistic equation ddmodel = 1  tdmodel == 4 : decline speciation rate expected number species matches ddmodel = 1 mu cond Conditioning:  cond == 0 : conditioning stem crown age  cond == 1 : conditioning stem crown age non-extinction phylogeny  cond == 2 : conditioning stem crown age total number extant taxa (including missing species)  cond == 3 : conditioning total number extant taxa (including missing species) btorph Sets whether likelihood branching times (0) phylogeny (1) soc Sets whether stem crown age used (1 2) tol Sets tolerances optimization. Consists :  reltolx = relative tolerance parameter values optimization  reltolf = relative tolerance function value optimization  abstolx = absolute tolerance parameter values optimization maxiter Sets maximum number iterations optimization changeloglikifnoconv TRUE loglik set -Inf ML converge optimmethod Method used optimization likelihood. Current default 'subplex'. Alternative 'simplex' (default previous versions) num_cycles number cycles opimization. set Inf, many cycles needed meet tolerance set target function. methode method used solve master equation tdmodel = 4, default 'odeint::runge_kutta_cash_karp54'. verbose Show parameters loglikelihood every call loglik function","code":""},{"path":"https://rsetienne.github.io/DDD/reference/bd_ML.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Maximization of the loglikelihood under the diversity-independent, possibly time-dependent diversification model — bd_ML","text":"dataframe following elements: lambda0 gives maximum likelihood estimate lambda0 mu0 gives maximum likelihood estimate mu0 lambda1 gives maximum likelihood estimate lambda1 mu1 gives maximum likelihood estimate mu1 loglik gives maximum loglikelihood df gives number estimated parameters, .e. degrees feedom conv gives message convergence optimization; conv = 0 means convergence","code":""},{"path":"https://rsetienne.github.io/DDD/reference/bd_ML.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Maximization of the loglikelihood under the diversity-independent, possibly time-dependent diversification model — bd_ML","text":"output dataframe containing estimated parameters maximum loglikelihood. computed loglikelihood contains factor q! m! / (q + m)! q number species phylogeny m number missing species, explained supplementary material Etienne et al. 2012.","code":""},{"path":"https://rsetienne.github.io/DDD/reference/bd_ML.html","id":"references","dir":"Reference","previous_headings":"","what":"References","title":"Maximization of the loglikelihood under the diversity-independent, possibly time-dependent diversification model — bd_ML","text":"- Etienne, R.S. et al. 2012, Proc. Roy. Soc. B 279: 1300-1309, doi: 10.1098/rspb.2011.1439  - Etienne, R.S. & B. Haegeman 2012. . Nat. 180: E75-E89, doi: 10.1086/667574","code":""},{"path":[]},{"path":"https://rsetienne.github.io/DDD/reference/bd_ML.html","id":"author","dir":"Reference","previous_headings":"","what":"Author","title":"Maximization of the loglikelihood under the diversity-independent, possibly time-dependent diversification model — bd_ML","text":"Rampal S. Etienne & Bart Haegeman","code":""},{"path":"https://rsetienne.github.io/DDD/reference/bd_ML.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Maximization of the loglikelihood under the diversity-independent, possibly time-dependent diversification model — bd_ML","text":"","code":"cat(\"Estimating parameters for a set of branching times brts with the default settings:\") #> Estimating parameters for a set of branching times brts with the default settings: brts = 1:20 bd_ML(brts = brts, cond = 1) #> You are optimizing lambda0 mu0  #> You are fixing lambda1 mu1  #> Optimizing the likelihood - this may take a while.  #> The loglikelihood for the initial parameter values is -67.8956450330451. #>  #> Maximum likelihood parameter estimates: lambda0: 0.082413, mu0: 0.000012, lambda1: 0.000000, mu1: 0.000000:  #> Maximum loglikelihood: -66.379536 #>      lambda0          mu0 lambda1 mu1    loglik df conv #> 1 0.08241342 1.162588e-05       0   0 -66.37954  2    0"},{"path":"https://rsetienne.github.io/DDD/reference/bd_loglik.html","id":null,"dir":"Reference","previous_headings":"","what":"Loglikelihood for diversity-independent diversification model — bd_loglik","title":"Loglikelihood for diversity-independent diversification model — bd_loglik","text":"function computes loglikelihood diversity-independent diversification model given set branching times parameter values.","code":""},{"path":"https://rsetienne.github.io/DDD/reference/bd_loglik.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Loglikelihood for diversity-independent diversification model — bd_loglik","text":"","code":"bd_loglik(   pars1,   pars2,   brts,   missnumspec,   methode = \"odeint::runge_kutta_cash_karp54\" )"},{"path":"https://rsetienne.github.io/DDD/reference/bd_loglik.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Loglikelihood for diversity-independent diversification model — bd_loglik","text":"pars1 Vector parameters: pars1[1] corresponds lambda0 (speciation rate) pars1[2] corresponds mu0 (extinction rate) pars1[3] corresponds lambda1 (decline parameter speciation rate) K diversity-dependence-like models pars1[4] corresponds mu1 (decline parameter extinction rate) pars2 Vector model settings: pars2[1] sets model time-dependence:  - pars2[1] == 0 time dependence  - pars2[1] == 1 speciation /extinction rate exponentially declining time  - pars2[1] == 2 stepwise decline speciation rate diversity-dependence without extinction  - pars2[1] == 3 decline speciation rate following deterministic logistic equation ddmodel = 1  - pars2[1] == 4 decline speciation rate expected number species matches ddmodel = 1 mu pars2[2] sets conditioning:  - pars[2] == 0 conditioning stem crown age  - pars[2] == 1 conditioning stem crown age non-extinction phylogeny  - pars[2] == 2 conditioning stem crown age total number extant taxa (including missing species)  - pars[2] == 3 conditioning total number extant taxa (including missing species) pars2[3] sets whether likelihood branching times (0) phylogeny (1) pars2[4] sets whether parameters likelihood shown screen (1) (0) pars2[5] sets whether first data point stem age (1) crown age (2) brts set branching times phylogeny, positive missnumspec number species clade missing phylogeny methode method used solve master equation, default 'odeint::runge_kutta_cash_karp54'.","code":""},{"path":"https://rsetienne.github.io/DDD/reference/bd_loglik.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Loglikelihood for diversity-independent diversification model — bd_loglik","text":"loglikelihood","code":""},{"path":"https://rsetienne.github.io/DDD/reference/bd_loglik.html","id":"references","dir":"Reference","previous_headings":"","what":"References","title":"Loglikelihood for diversity-independent diversification model — bd_loglik","text":"- Etienne, R.S. et al. 2012, Proc. Roy. Soc. B 279: 1300-1309, doi: 10.1098/rspb.2011.1439  - Etienne, R.S. & B. Haegeman 2012. . Nat. 180: E75-E89, doi: 10.1086/667574","code":""},{"path":[]},{"path":"https://rsetienne.github.io/DDD/reference/bd_loglik.html","id":"author","dir":"Reference","previous_headings":"","what":"Author","title":"Loglikelihood for diversity-independent diversification model — bd_loglik","text":"Rampal S. Etienne, Bart Haegeman & Cesar Martinez","code":""},{"path":"https://rsetienne.github.io/DDD/reference/bd_loglik.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Loglikelihood for diversity-independent diversification model — bd_loglik","text":"","code":"bd_loglik(pars1 = c(0.5,0.1), pars2 = c(0,1,1,0,2), brts = 1:10,  missnumspec = 0) #> [1] -35.86764"},{"path":"https://rsetienne.github.io/DDD/reference/brts2phylo.html","id":null,"dir":"Reference","previous_headings":"","what":"Function to convert a set of branching times into a phylogeny with random topology This code is taken from the package TESS by Sebastian Hoehna, where the function is called tess.create.phylo — brts2phylo","title":"Function to convert a set of branching times into a phylogeny with random topology This code is taken from the package TESS by Sebastian Hoehna, where the function is called tess.create.phylo — brts2phylo","text":"Converting set branching times phylogeny","code":""},{"path":"https://rsetienne.github.io/DDD/reference/brts2phylo.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Function to convert a set of branching times into a phylogeny with random topology This code is taken from the package TESS by Sebastian Hoehna, where the function is called tess.create.phylo — brts2phylo","text":"","code":"brts2phylo(times, root = FALSE, tip.label = NULL)"},{"path":"https://rsetienne.github.io/DDD/reference/brts2phylo.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Function to convert a set of branching times into a phylogeny with random topology This code is taken from the package TESS by Sebastian Hoehna, where the function is called tess.create.phylo — brts2phylo","text":"times Set branching times root root FALSE, largest branching time assumed crown age. root TRUE, stem age. tip.label Tip labels. set NULL, labels t1, t2, etc.","code":""},{"path":"https://rsetienne.github.io/DDD/reference/brts2phylo.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Function to convert a set of branching times into a phylogeny with random topology This code is taken from the package TESS by Sebastian Hoehna, where the function is called tess.create.phylo — brts2phylo","text":"phy phylogeny phylo type","code":""},{"path":"https://rsetienne.github.io/DDD/reference/brts2phylo.html","id":"references","dir":"Reference","previous_headings":"","what":"References","title":"Function to convert a set of branching times into a phylogeny with random topology This code is taken from the package TESS by Sebastian Hoehna, where the function is called tess.create.phylo — brts2phylo","text":"- Etienne, R.S. et al. 2012, Proc. Roy. Soc. B 279: 1300-1309, doi: 10.1098/rspb.2011.1439  - Etienne, R.S. & B. Haegeman 2012. . Nat. 180: E75-E89, doi: 10.1086/667574","code":""},{"path":"https://rsetienne.github.io/DDD/reference/brts2phylo.html","id":"author","dir":"Reference","previous_headings":"","what":"Author","title":"Function to convert a set of branching times into a phylogeny with random topology This code is taken from the package TESS by Sebastian Hoehna, where the function is called tess.create.phylo — brts2phylo","text":"Rampal S. Etienne","code":""},{"path":"https://rsetienne.github.io/DDD/reference/conv.html","id":null,"dir":"Reference","previous_headings":"","what":"Function to do convolution of two vectors — conv","title":"Function to do convolution of two vectors — conv","text":"Convolution two vectors","code":""},{"path":"https://rsetienne.github.io/DDD/reference/conv.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Function to do convolution of two vectors — conv","text":"","code":"conv(x, y)"},{"path":"https://rsetienne.github.io/DDD/reference/conv.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Function to do convolution of two vectors — conv","text":"x first vector y second vector","code":""},{"path":"https://rsetienne.github.io/DDD/reference/conv.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Function to do convolution of two vectors — conv","text":"vector convolution x y","code":""},{"path":"https://rsetienne.github.io/DDD/reference/conv.html","id":"references","dir":"Reference","previous_headings":"","what":"References","title":"Function to do convolution of two vectors — conv","text":"- Etienne, R.S. et al. 2012, Proc. Roy. Soc. B 279: 1300-1309, doi: 10.1098/rspb.2011.1439  - Etienne, R.S. & B. Haegeman 2012. . Nat. 180: E75-E89, doi: 10.1086/667574","code":""},{"path":"https://rsetienne.github.io/DDD/reference/conv.html","id":"author","dir":"Reference","previous_headings":"","what":"Author","title":"Function to do convolution of two vectors — conv","text":"Rampal S. Etienne","code":""},{"path":"https://rsetienne.github.io/DDD/reference/conv.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Function to do convolution of two vectors — conv","text":"","code":"conv(1:10,1:10) #>  [1]   1   4  10  20  35  56  84 120 165 220 264 296 315 320 310 284 241 180 100"},{"path":"https://rsetienne.github.io/DDD/reference/dd_KI_ML.html","id":null,"dir":"Reference","previous_headings":"","what":"Maximization of the loglikelihood under a diversity-dependent diversification model with decoupling of a subclade's diversication dynamics from the main clade's dynamics — dd_KI_ML","title":"Maximization of the loglikelihood under a diversity-dependent diversification model with decoupling of a subclade's diversication dynamics from the main clade's dynamics — dd_KI_ML","text":"function computes maximum likelihood estimates parameters diversity-dependent diversification model decoupling diversification dynamics subclade dynamics main clade given set phylogenetic branching times main clade subclade time splitting lineage form subclade.  also outputs corresponding loglikelihood can used model comparisons.","code":""},{"path":"https://rsetienne.github.io/DDD/reference/dd_KI_ML.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Maximization of the loglikelihood under a diversity-dependent diversification model with decoupling of a subclade's diversication dynamics from the main clade's dynamics — dd_KI_ML","text":"","code":"dd_KI_ML(   brtsM,   brtsS,   tsplit,   initparsopt = c(0.5, 0.1, 2 * (1 + length(brtsM) + missnumspec[1]), 2 * (1 +     length(brtsS) + missnumspec[length(missnumspec)]), (tsplit + max(brtsS))/2),   parsfix = NULL,   idparsopt = c(1:3, 6:7),   idparsfix = NULL,   idparsnoshift = (1:7)[c(-idparsopt, (-1)^(length(idparsfix) != 0) * idparsfix)],   res = 10 * (1 + length(c(brtsM, brtsS)) + sum(missnumspec)),   ddmodel = 1,   missnumspec = 0,   cond = 1,   soc = 2,   tol = c(0.001, 1e-04, 1e-06),   maxiter = 1000 * round((1.25)^length(idparsopt)),   changeloglikifnoconv = FALSE,   optimmethod = \"subplex\",   num_cycles = 1,   methode = \"analytical\",   correction = TRUE,   verbose = FALSE )"},{"path":"https://rsetienne.github.io/DDD/reference/dd_KI_ML.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Maximization of the loglikelihood under a diversity-dependent diversification model with decoupling of a subclade's diversication dynamics from the main clade's dynamics — dd_KI_ML","text":"brtsM set branching times main clade phylogeny, positive brtsS set branching times subclade phylogeny, positive tsplit branching time lineage forming subclade branches , positive initparsopt initial values parameters must optimized parsfix values parameters optimized idparsopt ids parameters must optimized, e.g. 1:7 parameters.  ids defined follows:  id == 1 corresponds lambda_M (speciation rate) main clade  id == 2 corresponds mu_M (extinction rate) main clade  id == 3 corresponds K_M (clade-level carrying capacity) main clade  id == 4 corresponds lambda_S (speciation rate) subclade  id == 5 corresponds mu_S (extinction rate) subclade  id == 6 corresponds K_S (clade-level carrying capacity) subclade  id == 7 corresponds t_d (time decoupling) idparsfix ids parameters optimized, e.g. c(1,3,4,6) lambda K optimized, mu. case idparsopt must c(2,5,7). default fix parameters specified idparsopt. idparsnoshift ids parameters shift; can apply ids 4, 5 6, e.g. idparsnoshift = c(4,5) means lambda mu values tshift res sets maximum number species probability must computed, must larger 1 + max(length(brtsM),length(brtsS)) ddmodel sets model diversity-dependence: ddmodel == 1 : linear dependence speciation rate parameter K (= diversity speciation = extinction)ddmodel == 1.3 : linear dependence speciation rate parameter K' (= diversity speciation = 0)ddmodel == 2 : exponential dependence speciation rate parameter K (= diversity speciation = extinction)ddmodel == 2.1 : variant exponential dependence speciation rate offset infinityddmodel == 2.2 : 1/n dependence speciation rateddmodel == 2.3 : exponential dependence speciation rate parameter x (= exponent)ddmodel == 3 : linear dependence extinction rate ddmodel == 4 : exponential dependence extinction rate ddmodel == 4.1 : variant exponential dependence extinction rate offset infinity ddmodel == 4.2 : 1/n dependence extinction rate offset infinity missnumspec number species clade missing phylogeny. One can specify sum missing species main clade subclade vector c(missnumspec_M,missnumspec_S) missing species main clade subclade respectively. cond Conditioning:  cond == 0 : conditioning  cond == 1 : conditioning non-extinction phylogeny soc Sets whether stem crown age used (1 2); stem age works cond = 0 tol Sets tolerances optimization. Consists :  reltolx = relative tolerance parameter values optimization  reltolf = relative tolerance function value optimization  abstolx = absolute tolerance parameter values optimization maxiter Sets maximum number iterations optimization changeloglikifnoconv TRUE loglik set -Inf ML converge optimmethod Method used optimization likelihood. Current default 'subplex'. Alternative 'simplex' (default previous versions) num_cycles number cycles opimization. set Inf, many cycles needed meet tolerance set target function. methode method used solve master equation, default 'analytical' uses matrix exponentiation; alternatively numerical ODE solvers can used, 'odeint::runge_kutta_cash_karp54'. used package version 3.1. correction Sets whether correction applied (TRUE) (FALSE) verbose Show parameters loglikelihood every call loglik function","code":""},{"path":"https://rsetienne.github.io/DDD/reference/dd_KI_ML.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Maximization of the loglikelihood under a diversity-dependent diversification model with decoupling of a subclade's diversication dynamics from the main clade's dynamics — dd_KI_ML","text":"lambda_M gives maximum likelihood estimate lambda main clade mu_M gives maximum likelihood estimate mu main clade K_M gives maximum likelihood estimate K main clade lambda_2 gives maximum likelihood estimate lambda subclade mu_S gives maximum likelihood estimate mu subclade K_S gives maximum likelihood estimate K subclade t_d gives time decoupling event loglik gives maximum loglikelihood df gives number estimated parameters, .e. degrees feedom conv gives message convergence optimization; conv = 0 means convergence","code":""},{"path":"https://rsetienne.github.io/DDD/reference/dd_KI_ML.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Maximization of the loglikelihood under a diversity-dependent diversification model with decoupling of a subclade's diversication dynamics from the main clade's dynamics — dd_KI_ML","text":"output dataframe containing estimated parameters maximum loglikelihood. computed loglikelihood contains factor q! m!/(q + m)! q number species phylogeny m number missing species, explained supplementary material Etienne et al. 2012.","code":""},{"path":"https://rsetienne.github.io/DDD/reference/dd_KI_ML.html","id":"note","dir":"Reference","previous_headings":"","what":"Note","title":"Maximization of the loglikelihood under a diversity-dependent diversification model with decoupling of a subclade's diversication dynamics from the main clade's dynamics — dd_KI_ML","text":"optimization may get trapped local optima. Try different starting values search global optimum.","code":""},{"path":"https://rsetienne.github.io/DDD/reference/dd_KI_ML.html","id":"references","dir":"Reference","previous_headings":"","what":"References","title":"Maximization of the loglikelihood under a diversity-dependent diversification model with decoupling of a subclade's diversication dynamics from the main clade's dynamics — dd_KI_ML","text":"- Etienne, R.S. et al. 2012, Proc. Roy. Soc. B 279: 1300-1309, doi: 10.1098/rspb.2011.1439  - Etienne, R.S. & B. Haegeman 2012. . Nat. 180: E75-E89, doi: 10.1086/667574","code":""},{"path":[]},{"path":"https://rsetienne.github.io/DDD/reference/dd_KI_ML.html","id":"author","dir":"Reference","previous_headings":"","what":"Author","title":"Maximization of the loglikelihood under a diversity-dependent diversification model with decoupling of a subclade's diversication dynamics from the main clade's dynamics — dd_KI_ML","text":"Rampal S. Etienne & Bart Haegeman","code":""},{"path":"https://rsetienne.github.io/DDD/reference/dd_KI_ML.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Maximization of the loglikelihood under a diversity-dependent diversification model with decoupling of a subclade's diversication dynamics from the main clade's dynamics — dd_KI_ML","text":"","code":"cat(\"This will estimate parameters for two sets of branching times brtsM, brtsS\\n\") #> This will estimate parameters for two sets of branching times brtsM, brtsS cat(\"without conditioning.\\n\") #> without conditioning. cat(\"The tolerance of the optimization is set high so runtime is fast in this example.\\n\") #> The tolerance of the optimization is set high so runtime is fast in this example. cat(\"In real applications, use the default or more stringent settins for tol.\\n\") #> In real applications, use the default or more stringent settins for tol. brtsM = 4:10 brtsS = seq(0.1,3.5,0.7) tsplit = 5 dd_KI_ML(brtsM = brtsM, brtsS = brtsS, tsplit = tsplit, idparsopt = c(1:3,6,7),   initparsopt = c(0.885, 2e-14, 6.999, 6.848, 4.001), idparsfix = NULL,   parsfix = NULL,idparsnoshift = c(4,5), cond = 0, tol = c(3E-1,3E-1,3E-1),   optimmethod = 'simplex') #> You are optimizing la_M mu_M K_M K_S t_d  #> You are fixing nothing  #> You are not shifting la_S mu_S  #> Optimizing the likelihood - this may take a while.  #> The loglikelihood for the initial parameter values is -24.45333  #> 1 0.885 2e-14 6.999 6.848 4.001 -24.4533303187317 initial  #> Optimization has terminated successfully.  #>  #> Maximum likelihood parameter estimates: 0.885000 0.000000 6.999000 0.885000 0.000000 6.848000 4.001000 #> Maximum loglikelihood: -24.453330"},{"path":"https://rsetienne.github.io/DDD/reference/dd_KI_loglik.html","id":null,"dir":"Reference","previous_headings":"","what":"Loglikelihood for diversity-dependent diversification models with decoupling of a subclade from a main clade at time t = t_d — dd_KI_loglik","title":"Loglikelihood for diversity-dependent diversification models with decoupling of a subclade from a main clade at time t = t_d — dd_KI_loglik","text":"function computes loglikelihood diversity-dependent diversification model given set branching times parameter values diversity-dependent dynamics subclade decouple dynamics main clade time t_d, potentially accompanied shift parameters.","code":""},{"path":"https://rsetienne.github.io/DDD/reference/dd_KI_loglik.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Loglikelihood for diversity-dependent diversification models with decoupling of a subclade from a main clade at time t = t_d — dd_KI_loglik","text":"","code":"dd_KI_loglik(   pars1,   pars2,   brtsM,   brtsS,   missnumspec,   methode = \"odeint::runge_kutta_cash_karp54\" )"},{"path":"https://rsetienne.github.io/DDD/reference/dd_KI_loglik.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Loglikelihood for diversity-dependent diversification models with decoupling of a subclade from a main clade at time t = t_d — dd_KI_loglik","text":"pars1 Vector parameters: pars1[1] corresponds lambda_M (speciation rate) main clade pars1[2] corresponds mu_M (extinction rate) main clade pars1[3] corresponds K_M (clade-level carrying capacity) main clade pars1[4] corresponds lambda_S (speciation rate) subclade pars1[5] corresponds mu_S (extinction rate) subclade pars1[6] corresponds K_S (clade-level carrying capacity) subclade pars1[7] corresponds t_d (time decoupling) pars2 Vector model settings: pars2[1] sets maximum number species probability must computed.  must larger 1 + missnumspec + length(brts). pars2[2] sets model diversity-dependence:  - pars2[2] == 1 linear dependence speciation rate parameter K (= diversity speciation = extinction) - pars2[2] == 1.3 linear dependence speciation rate parameter K' (= diversity speciation = 0) - pars2[2] == 2 exponential dependence speciation rate parameter K (= diversity speciation = extinction) - pars2[2] == 2.1 variant exponential dependence speciation rate offset infinity - pars2[2] == 2.2 1/n dependence speciation rate - pars2[2] == 2.3 exponential dependence speciation rate parameter x (= exponent) - pars2[2] == 3 linear dependence extinction rate  - pars2[2] == 4 exponential dependence extinction rate  - pars2[2] == 4.1 variant exponential dependence extinction rate offset infinity - pars2[2] == 4.2 1/n dependence extinction ratepars2[3] sets conditioning:  - pars2[3] == 0 conditioning (just crown age)  - pars2[3] == 1 conditioning non-extinction phylogeny  - pars2[3] == 2 conditioning number species crown age; yet implemented  - pars2[3] == 3 conditioning number species ; yet implemented  - pars2[3] == 4 conditioning survival subclade  - pars2[3] == 5 conditioning survival subclades crown lineages main clade. assumes subclades already shifted undergo another shift, .e. shifts occur main clade. pars2[4] Obsolete. pars2[5] sets whether parameters likelihood shown screen (1) (0) pars2[6] sets whether first data point stem age (1) crown age (2) pars2[7] sets whether old (incorrect) likelihood used (0), whether new corrected likelihood used (1). brtsM set branching times main clade phylogeny, positive brtsS set branching times subclade phylogeny, positive missnumspec number species clade missing phylogeny. One can specify sum missing species main clade subclade vector c(missnumspec_M,missnumspec_S) missing species main clade subclade respectively. methode method used solve master equation, default 'analytical' uses matrix exponentiation; alternatively numerical ODE solvers can used, 'odeint::runge_kutta_cash_karp54'. used package version 3.1.","code":""},{"path":"https://rsetienne.github.io/DDD/reference/dd_KI_loglik.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Loglikelihood for diversity-dependent diversification models with decoupling of a subclade from a main clade at time t = t_d — dd_KI_loglik","text":"loglikelihood","code":""},{"path":"https://rsetienne.github.io/DDD/reference/dd_KI_loglik.html","id":"references","dir":"Reference","previous_headings":"","what":"References","title":"Loglikelihood for diversity-dependent diversification models with decoupling of a subclade from a main clade at time t = t_d — dd_KI_loglik","text":"- Etienne, R.S. et al. 2012, Proc. Roy. Soc. B 279: 1300-1309, doi: 10.1098/rspb.2011.1439  - Etienne, R.S. & B. Haegeman 2012. . Nat. 180: E75-E89, doi: 10.1086/667574","code":""},{"path":[]},{"path":"https://rsetienne.github.io/DDD/reference/dd_KI_loglik.html","id":"author","dir":"Reference","previous_headings":"","what":"Author","title":"Loglikelihood for diversity-dependent diversification models with decoupling of a subclade from a main clade at time t = t_d — dd_KI_loglik","text":"Rampal S. Etienne & Bart Haegeman","code":""},{"path":"https://rsetienne.github.io/DDD/reference/dd_KI_loglik.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Loglikelihood for diversity-dependent diversification models with decoupling of a subclade from a main clade at time t = t_d — dd_KI_loglik","text":"","code":"pars1 = c(0.25,0.12,25.51,1.0,0.16,8.61,9.8) pars2 = c(200,1,0,18.8,1,2) missnumspec = 0 brtsM = c(25.2,24.6,24.0,22.5,21.7,20.4,19.9,19.7,18.8,17.1,15.8,11.8,9.7,8.9,5.7,5.2) brtsS = c(9.6,8.6,7.4,4.9,2.5) dd_KI_loglik(pars1,pars2,brtsM,brtsS,missnumspec) #> Parameters: 0.250000 0.120000 25.510000 1.000000 0.160000 8.610000 9.800000, Loglikelihood: -77.815687 #> [1] -77.81569"},{"path":"https://rsetienne.github.io/DDD/reference/dd_KI_sim.html","id":null,"dir":"Reference","previous_headings":"","what":"Function to simulate a key innovation in macro-evolution with the innovative clade decoupling from the diversity-dependent diversification dynamics of the main clade — dd_KI_sim","title":"Function to simulate a key innovation in macro-evolution with the innovative clade decoupling from the diversity-dependent diversification dynamics of the main clade — dd_KI_sim","text":"Simulating diversity-dependent diversification process given time new clade emerges different inherent speciation rate extinction rate clade-level carrying capacity decoupled dynamics","code":""},{"path":"https://rsetienne.github.io/DDD/reference/dd_KI_sim.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Function to simulate a key innovation in macro-evolution with the innovative clade decoupling from the diversity-dependent diversification dynamics of the main clade — dd_KI_sim","text":"","code":"dd_KI_sim(pars, age, ddmodel = 1)"},{"path":"https://rsetienne.github.io/DDD/reference/dd_KI_sim.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Function to simulate a key innovation in macro-evolution with the innovative clade decoupling from the diversity-dependent diversification dynamics of the main clade — dd_KI_sim","text":"pars Vector parameters: pars[1] corresponds lambda_M (speciation rate main clade) pars[2] corresponds mu_M (extinction rate main clade) pars[3] corresponds K_M (clade-level carrying capacity main clade) pars[4] corresponds lambda_S (speciation rate subclade) pars[5] corresponds mu_S (extinction rate subclade) pars[5] corresponds K_S (clade-level carrying capacity subclade) pars[7] tinn, time shift rates occurs lineage leading subclade age Sets crown age simulation ddmodel Sets model diversity-dependence: ddmodel == 1 : linear dependence speciation rate parameter K (= diversity speciation = extinction)ddmodel == 1.3 : linear dependence speciation rate parameter K' (= diversity speciation = 0)ddmodel == 2 : exponential dependence speciation rate parameter K (= diversity speciation = extinction)ddmodel == 2.1 : variant exponential dependence speciation rate offset infinityddmodel == 2.2 : 1/n dependence speciation rateddmodel == 2.3 : exponential dependence speciation rate parameter x (= exponent)ddmodel == 3 : linear dependence extinction rate ddmodel == 4 : exponential dependence extinction rate ddmodel == 4.1 : variant exponential dependence extinction rate offset infinity ddmodel == 4.2 : 1/n dependence extinction rate offset infinity","code":""},{"path":"https://rsetienne.github.io/DDD/reference/dd_KI_sim.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Function to simulate a key innovation in macro-evolution with the innovative clade decoupling from the diversity-dependent diversification dynamics of the main clade — dd_KI_sim","text":"list following elements: first element tree extant species phylo format  second element tree species, including extinct species, phylo format  third element matrix species  - first column time species born  - second column label parent species; positive negative values indicate whether species belongs left right crown lineage  - third column label daughter species ; positive negative values indicate whether species belongs left right crown lineage  - fourth column time extinction species  fourth element equals -1, species still extant. - fifth column indicates whether species belong main clade (0) subclade (1) fourth element subclade tree extant species (without stem)  fifth element subclade tree species (without stem)  sixth element first, except attributed 0 main clade 1 subclade seventh element Second, except attributed 0 main clade 1 subclade sixth seventh element NULL subclade exist (went extinct).","code":""},{"path":"https://rsetienne.github.io/DDD/reference/dd_KI_sim.html","id":"references","dir":"Reference","previous_headings":"","what":"References","title":"Function to simulate a key innovation in macro-evolution with the innovative clade decoupling from the diversity-dependent diversification dynamics of the main clade — dd_KI_sim","text":"- Etienne, R.S. et al. 2012, Proc. Roy. Soc. B 279: 1300-1309, doi: 10.1098/rspb.2011.1439  - Etienne, R.S. & B. Haegeman 2012. . Nat. 180: E75-E89, doi: 10.1086/667574","code":""},{"path":"https://rsetienne.github.io/DDD/reference/dd_KI_sim.html","id":"author","dir":"Reference","previous_headings":"","what":"Author","title":"Function to simulate a key innovation in macro-evolution with the innovative clade decoupling from the diversity-dependent diversification dynamics of the main clade — dd_KI_sim","text":"Rampal S. Etienne","code":""},{"path":"https://rsetienne.github.io/DDD/reference/dd_KI_sim.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Function to simulate a key innovation in macro-evolution with the innovative clade decoupling from the diversity-dependent diversification dynamics of the main clade — dd_KI_sim","text":"","code":"dd_KI_sim(c(0.2,0.1,20,0.1,0.05,30,4),10)    #> $tes #>  #> Phylogenetic tree with 6 tips and 5 internal nodes. #>  #> Tip labels: #>   t1, t7, t9, t8, t3, t4 #>  #> Rooted; includes branch lengths. #>  #> $tas #>  #> Phylogenetic tree with 9 tips and 8 internal nodes. #>  #> Tip labels: #>   t1, t7, t9, t8, t5, t2, ... #>  #> Rooted; includes branch lengths. #>  #> $L #>            [,1] [,2] [,3]      [,4] [,5] #>  [1,] 10.000000    0   -1 -1.000000    0 #>  [2,] 10.000000   -1    2  8.003286    0 #>  [3,]  9.381329    2    3 -1.000000    0 #>  [4,]  7.972618    3    4 -1.000000    1 #>  [5,]  7.650547   -1   -5  5.786228    0 #>  [6,]  6.857887    3    6  2.240755    0 #>  [7,]  2.054015   -1   -7 -1.000000    0 #>  [8,]  1.426913   -7   -8 -1.000000    0 #>  [9,]  1.011446   -7   -9 -1.000000    0 #>  #> $tesS #> NULL #>  #> $tasS #> NULL #>  #> $tes2 #>  #> Phylogenetic tree with 6 tips and 5 internal nodes. #>  #> Tip labels: #> [1] \"t1\" \"t7\" \"t9\" \"t8\" \"t3\" \"t4\" #>  #> The tree includes a mapped, 2-state discrete character #> with states: #> \t0, 1 #>  #> Rooted; includes branch lengths. #>  #> $tas2 #>  #> Phylogenetic tree with 9 tips and 8 internal nodes. #>  #> Tip labels: #> \tt1, t7, t9, t8, t5, t2, ... #>  #> The tree includes a mapped, 2-state discrete character #> with states: #> \t0, 1 #>  #> Rooted; includes branch lengths. #>"},{"path":"https://rsetienne.github.io/DDD/reference/dd_LR.html","id":null,"dir":"Reference","previous_headings":"","what":"Bootstrap likelihood ratio test of diversity-dependent diversification model — dd_LR","title":"Bootstrap likelihood ratio test of diversity-dependent diversification model — dd_LR","text":"function computes maximum likelihood associated estimates parameters diversity-dependent diversification model given set phylogenetic branching times. performs bootstrap likelihood ratio test diversity-dependent (DD) model constant-rates (CR) birth-death model. Finally, computes power test.","code":""},{"path":"https://rsetienne.github.io/DDD/reference/dd_LR.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Bootstrap likelihood ratio test of diversity-dependent diversification model — dd_LR","text":"","code":"dd_LR(   brts,   initparsoptDD,   initparsoptCR,   missnumspec,   outputfilename = NULL,   seed = 42,   endmc = 1000,   alpha = 0.05,   plotit = TRUE,   res = 10 * (1 + length(brts) + missnumspec),   ddmodel = 1,   cond = 1,   btorph = 1,   soc = 2,   tol = c(0.001, 1e-04, 1e-06),   maxiter = 2000,   changeloglikifnoconv = FALSE,   optimmethod = \"subplex\",   methode = \"analytical\" )"},{"path":"https://rsetienne.github.io/DDD/reference/dd_LR.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Bootstrap likelihood ratio test of diversity-dependent diversification model — dd_LR","text":"brts set branching times phylogeny, positive initparsoptDD initial values parameters must optimized diversity-dependent (DD) model: lambda_0, mu K initparsoptCR initial values parameters must optimized constant-rates (CR) model: lambda mu missnumspec number species clade missing phylogeny outputfilename name (location) file output saved. Default save. seed seed pseudo random number generator simulating bootstrap data endmc number bootstraps alpha significance level test plotit Boolean plot results res Sets maximum number species probability must computed, must larger 1 + length(brts) ddmodel Sets model diversity-dependence: ddmodel == 1 : linear dependence speciation rate parameter K (= diversity speciation = extinction)ddmodel == 1.3 : linear dependence speciation rate parameter K' (= diversity speciation = 0)ddmodel == 2 : exponential dependence speciation rate parameter K (= diversity speciation = extinction)ddmodel == 2.1 : variant exponential dependence speciation rate offset infinityddmodel == 2.2 : 1/n dependence speciation rateddmodel == 2.3 : exponential dependence speciation rate parameter x (= exponent)ddmodel == 3 : linear dependence extinction rate ddmodel == 4 : exponential dependence extinction rate ddmodel == 4.1 : variant exponential dependence extinction rate offset infinity ddmodel == 4.2 : 1/n dependence extinction rate offset infinity ddmodel == 5 : linear dependence speciation extinction rate cond Conditioning:  cond == 0 : conditioning stem crown age  cond == 1 : conditioning stem crown age non-extinction phylogeny  cond == 2 : conditioning stem crown age total number extant taxa (including missing species)  cond == 3 : conditioning total number extant taxa (including missing species)  Note: cond == 3 assumes uniform prior stem age, standard constant-rate birth-death models, see e.g. D. Aldous & L. Popovic 2004. Adv. Appl. Prob. 37: 1094-1115 T. Stadler 2009. J. Theor. Biol. 261: 58-66. btorph Sets whether likelihood branching times (0) phylogeny (1) soc Sets whether stem crown age used (1 2) tol Sets tolerances optimization. Consists :  reltolx = relative tolerance parameter values optimization  reltolf = relative tolerance function value optimization  abstolx = absolute tolerance parameter values optimization maxiter Sets maximum number iterations optimization changeloglikifnoconv TRUE loglik set -Inf ML converge optimmethod Method used optimization likelihood. Current default 'subplex'. Alternative 'simplex' (default previous versions) methode method used solve master equation, default 'analytical' uses matrix exponentiation; alternatively numerical ODE solvers can used, 'odeint::runge_kutta_cash_karp54'. used package version 3.1.","code":""},{"path":"https://rsetienne.github.io/DDD/reference/dd_LR.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Bootstrap likelihood ratio test of diversity-dependent diversification model — dd_LR","text":"treeCR list trees generated constant-rates model using ML parameters CR model treeDD list trees generated diversity-dependent model using ML parameters diversity-dependent model dataframe parameter estimates maximum likelihoods diversity-dependent constant-rates models $model - model used generate data. 0 = unknown (real data), 1 = CR, 2 = DD $mc - simulation number model $lambda_CR - speciation rate estimated CR $mu_CR - extinction rate estimated CR $LL_CR - maximum likelihood estimated CR $conv_CR - convergence code likelihood optimization; conv = 0 means convergence $lambda_DD1 - initial speciation rate estimated DD first set initial values$mu_DD1 - extinction rate estimated DD first set initial values $K_DD1 - clade-wide carrying-capacity estimated DD first set initial values $LL_DD1 - maximum likelihood estimated DD first set initial values $conv_DD1 - convergence code likelihood optimization first set initial values; conv = 0 means convergence $lambda_DD2 - initial speciation rate estimated DD second set initial values$mu_DD2 - extinction rate estimated DD second set initial values $K_DD2 - clade-wide carrying-capacity estimated DD second set initial values $LL_DD2 - maximum likelihood estimated DD second set initial values $conv_DD2 - convergence code likelihood optimization second set initial values; conv = 0 means convergence $LR - likelihood ratio DD CR pvalue p-value test LRalpha Likelihood ratio signifiance level alpha poweroftest power test significance level alpha","code":""},{"path":"https://rsetienne.github.io/DDD/reference/dd_LR.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Bootstrap likelihood ratio test of diversity-dependent diversification model — dd_LR","text":"output list 3 elements:","code":""},{"path":"https://rsetienne.github.io/DDD/reference/dd_LR.html","id":"references","dir":"Reference","previous_headings":"","what":"References","title":"Bootstrap likelihood ratio test of diversity-dependent diversification model — dd_LR","text":"- Etienne, R.S. et al. 2016. Meth. Ecol. Evol. 7: 1092-1099, doi: 10.1111/2041-210X.12565  - Etienne, R.S. et al. 2012, Proc. Roy. Soc. B 279: 1300-1309, doi: 10.1098/rspb.2011.1439  - Etienne, R.S. & B. Haegeman 2012. . Nat. 180: E75-E89, doi: 10.1086/667574","code":""},{"path":[]},{"path":"https://rsetienne.github.io/DDD/reference/dd_LR.html","id":"author","dir":"Reference","previous_headings":"","what":"Author","title":"Bootstrap likelihood ratio test of diversity-dependent diversification model — dd_LR","text":"Rampal S. Etienne & Bart Haegeman","code":""},{"path":"https://rsetienne.github.io/DDD/reference/dd_ML.html","id":null,"dir":"Reference","previous_headings":"","what":"Maximization of the loglikelihood under a diversity-dependent diversification model — dd_ML","title":"Maximization of the loglikelihood under a diversity-dependent diversification model — dd_ML","text":"function computes maximum likelihood estimates parameters diversity-dependent diversification model given set phylogenetic branching times.  also outputs corresponding loglikelihood can used model comparisons.","code":""},{"path":"https://rsetienne.github.io/DDD/reference/dd_ML.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Maximization of the loglikelihood under a diversity-dependent diversification model — dd_ML","text":"","code":"dd_ML(   brts,   initparsopt = initparsoptdefault(ddmodel, brts, missnumspec),   idparsopt = 1:length(initparsopt),   idparsfix = (1:(3 + (ddmodel == 5)))[-idparsopt],   parsfix = parsfixdefault(ddmodel, brts, missnumspec, idparsopt),   res = 10 * (1 + length(brts) + missnumspec),   ddmodel = 1,   missnumspec = 0,   cond = 1,   btorph = 1,   soc = 2,   tol = c(0.001, 1e-04, 1e-06),   maxiter = 1000 * round((1.25)^length(idparsopt)),   changeloglikifnoconv = FALSE,   optimmethod = \"subplex\",   num_cycles = 1,   methode = \"analytical\",   verbose = FALSE )"},{"path":"https://rsetienne.github.io/DDD/reference/dd_ML.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Maximization of the loglikelihood under a diversity-dependent diversification model — dd_ML","text":"brts set branching times phylogeny, positive initparsopt initial values parameters must optimized idparsopt ids parameters must optimized, e.g. 1:3 intrinsic speciation rate, extinction rate carrying capacity.  ids defined follows:  id == 1 corresponds lambda (speciation rate)  id == 2 corresponds mu (extinction rate)  id == 3 corresponds K (clade-level carrying capacity)  id == 4 corresponds r (r = b/mu = mu_0 + b * N lambda = lambda_0 - * N) (available ddmodel = 5) idparsfix ids parameters optimized, e.g. c(1,3) lambda K optimized, mu. case idparsopt must 2. default fix parameters specified idparsopt. parsfix values parameters optimized res Sets maximum number species probability must computed, must larger 1 + length(brts) ddmodel Sets model diversity-dependence: ddmodel == 1 : linear dependence speciation rate parameter K (= diversity speciation = extinction)ddmodel == 1.3 : linear dependence speciation rate parameter K' (= diversity speciation = 0)ddmodel == 1.4 : positive diversity-dependence speciation rate parameter K' (= diversity speciation rate reaches half maximum); lambda = lambda0 * S/(S + K') S species richnessddmodel == 1.5 : positive negative dependence speciation rate parameter K' (= diversity speciation = 0); lambda = lambda0 * S/K' * (1 - S/K') S species richnessddmodel == 2 : exponential dependence speciation rate parameter K (= diversity speciation = extinction)ddmodel == 2.1 : variant exponential dependence speciation rate offset infinityddmodel == 2.2 : 1/n dependence speciation rateddmodel == 2.3 : exponential dependence speciation rate parameter x (= exponent)ddmodel == 3 : linear dependence extinction rate ddmodel == 4 : exponential dependence extinction rate ddmodel == 4.1 : variant exponential dependence extinction rate offset infinity ddmodel == 4.2 : 1/n dependence extinction rate offset infinity ddmodel == 5 : linear dependence speciation extinction rate missnumspec number species clade missing phylogeny cond Conditioning:  cond == 0 : conditioning stem crown age cond == 1 : conditioning stem crown age non-extinction phylogeny  cond == 2 : conditioning stem crown age total number extant taxa (including missing species)  cond == 3 : conditioning total number extant taxa (including missing species) Note: cond == 3 assumes uniform prior stem age, standard constant-rate birth-death models, see e.g. D. Aldous & L. Popovic 2004. Adv. Appl. Prob. 37: 1094-1115 T. Stadler 2009. J. Theor. Biol. 261: 58-66. btorph Sets whether likelihood branching times (0) phylogeny (1) soc Sets whether stem crown age used (1 2) tol Sets tolerances optimization. Consists :  reltolx = relative tolerance parameter values optimization  reltolf = relative tolerance function value optimization  abstolx = absolute tolerance parameter values optimization maxiter Sets maximum number iterations optimization changeloglikifnoconv TRUE loglik set -Inf ML converge optimmethod Method used optimization likelihood. Current default 'subplex'. Alternative 'simplex' (default previous versions) num_cycles number cycles opimization. set Inf, many cycles needed meet tolerance set target function. methode method used solve master equation, default 'analytical' uses matrix exponentiation; alternatively numerical ODE solvers can used, 'odeint::runge_kutta_cash_karp54'. used package version 3.1. verbose Show parameters loglikelihood every call loglik function","code":""},{"path":"https://rsetienne.github.io/DDD/reference/dd_ML.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Maximization of the loglikelihood under a diversity-dependent diversification model — dd_ML","text":"lambda gives maximum likelihood estimate lambda mu gives maximum likelihood estimate mu K gives maximum likelihood estimate K r (ddmodel == 5) gives ratio linear dependencies speciation extinction rates loglik gives maximum loglikelihood df gives number estimated parameters, .e. degrees feedom conv gives message convergence optimization; conv = 0 means convergence","code":""},{"path":"https://rsetienne.github.io/DDD/reference/dd_ML.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Maximization of the loglikelihood under a diversity-dependent diversification model — dd_ML","text":"output dataframe containing estimated parameters maximum loglikelihood. computed loglikelihood contains factor q! m! / (q + m)! q number species phylogeny m number missing species, explained supplementary material Etienne et al. 2012.","code":""},{"path":"https://rsetienne.github.io/DDD/reference/dd_ML.html","id":"references","dir":"Reference","previous_headings":"","what":"References","title":"Maximization of the loglikelihood under a diversity-dependent diversification model — dd_ML","text":"- Etienne, R.S. et al. 2012, Proc. Roy. Soc. B 279: 1300-1309, doi: 10.1098/rspb.2011.1439  - Etienne, R.S. & B. Haegeman 2012. . Nat. 180: E75-E89, doi: 10.1086/667574","code":""},{"path":[]},{"path":"https://rsetienne.github.io/DDD/reference/dd_ML.html","id":"author","dir":"Reference","previous_headings":"","what":"Author","title":"Maximization of the loglikelihood under a diversity-dependent diversification model — dd_ML","text":"Rampal S. Etienne & Bart Haegeman","code":""},{"path":"https://rsetienne.github.io/DDD/reference/dd_ML.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Maximization of the loglikelihood under a diversity-dependent diversification model — dd_ML","text":"","code":"cat(\"Estimating the intrinsic speciation rate lambda and the carrying capacity K\") #> Estimating the intrinsic speciation rate lambda and the carrying capacity K cat(\"for a fixed extinction rate of 0.1, conditioning on clade survival and two missing species:\") #> for a fixed extinction rate of 0.1, conditioning on clade survival and two missing species: brts = 1:5 dd_ML(brts = brts,initparsopt = c(1.3078,7.4188), idparsopt = c(1,3), parsfix = 0.1,       cond = 1, missnumspec = 2, tol = c(1E-3,1E-3,1E-4), optimmethod = 'simplex') #> You are optimizing lambda K  #> You are fixing mu  #> Optimizing the likelihood - this may take a while.  #> The loglikelihood for the initial parameter values is -9.349088  #> 1 1.3078 7.41879999999999 -9.3490879225759 initial  #> 2 1.3078 7.41879999999999 -9.3490879225759 contract inside  #> 3 1.3078 7.41879999999999 -9.3490879225759 contract inside  #> 4 1.3078 7.41879999999999 -9.3490879225759 contract inside  #> 5 1.3078 7.41879999999999 -9.3490879225759 reflect  #> 6 1.3078 7.41879999999999 -9.3490879225759 contract inside  #> 7 1.3078 7.41879999999999 -9.3490879225759 contract outside  #> 8 1.3078 7.41879999999999 -9.3490879225759 contract inside  #> 9 1.3078 7.41879999999999 -9.3490879225759 reflect  #> 10 1.3078 7.41879999999999 -9.3490879225759 contract inside  #> 11 1.3078 7.41879999999999 -9.3490879225759 contract outside  #> 12 1.3078 7.41879999999999 -9.3490879225759 contract outside  #> 13 1.3078 7.41879999999999 -9.3490879225759 contract outside  #> 14 1.3078 7.41879999999999 -9.3490879225759 contract outside  #> 15 1.3078 7.41879999999999 -9.3490879225759 contract outside  #> 16 1.3078 7.41879999999999 -9.3490879225759 contract outside  #> 17 1.3078 7.41879999999999 -9.3490879225759 contract outside  #> 18 1.3078 7.41879999999999 -9.3490879225759 contract outside  #> 19 1.3078 7.41879999999999 -9.3490879225759 contract outside  #> 20 1.3078 7.41879999999999 -9.3490879225759 contract inside  #> Optimization has terminated successfully.  #>  #> Maximum likelihood parameter estimates: lambda: 1.307800, mu: 0.100000, K: 7.418800 #> Maximum loglikelihood: -9.349088"},{"path":"https://rsetienne.github.io/DDD/reference/dd_MS_ML.html","id":null,"dir":"Reference","previous_headings":"","what":"Maximization of the loglikelihood under a diversity-dependent diversification model with decoupling of a subclade's diversication dynamics from the main clade's dynamics — dd_MS_ML","title":"Maximization of the loglikelihood under a diversity-dependent diversification model with decoupling of a subclade's diversication dynamics from the main clade's dynamics — dd_MS_ML","text":"function computes maximum likelihood estimates parameters diversity-dependent diversification model diversity-dependent dynamics innovative subclade different parameters dynamics main clade time t_d, governed carrying capacity experience 's diversity.  Required isa given set phylogenetic branching times main clade subclade time splitting lineage form subclade.  function also outputs corresponding loglikelihood can used model comparisons.","code":""},{"path":"https://rsetienne.github.io/DDD/reference/dd_MS_ML.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Maximization of the loglikelihood under a diversity-dependent diversification model with decoupling of a subclade's diversication dynamics from the main clade's dynamics — dd_MS_ML","text":"","code":"dd_MS_ML(   brtsM,   brtsS,   tsplit,   initparsopt = c(0.5, 0.1, 2 * (1 + length(brtsM) + length(brtsS) + sum(missnumspec)),     (tsplit + max(brtsS))/2),   parsfix = NULL,   idparsopt = c(1:3, 6),   idparsfix = NULL,   idparsnoshift = (1:6)[c(-idparsopt, (-1)^(length(idparsfix) != 0) * idparsfix)],   res = 10 * (1 + length(c(brtsM, brtsS)) + sum(missnumspec)),   ddmodel = 1.3,   missnumspec = 0,   cond = 0,   soc = 2,   tol = c(0.001, 1e-04, 1e-06),   maxiter = 1000 * round((1.25)^length(idparsopt)),   changeloglikifnoconv = FALSE,   optimmethod = \"subplex\",   num_cycles = 1,   methode = \"ode45\",   correction = FALSE,   verbose = FALSE )"},{"path":"https://rsetienne.github.io/DDD/reference/dd_MS_ML.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Maximization of the loglikelihood under a diversity-dependent diversification model with decoupling of a subclade's diversication dynamics from the main clade's dynamics — dd_MS_ML","text":"brtsM set branching times main clade phylogeny, positive brtsS set branching times subclade phylogeny, positive tsplit branching time lineage forming subclade branches , positive initparsopt initial values parameters must optimized parsfix values parameters optimized idparsopt ids parameters must optimized, e.g. 1:7 parameters.  ids defined follows:  id == 1 corresponds lambda_M (speciation rate) main clade  id == 2 corresponds mu_M (extinction rate) main clade  id == 3 corresponds K_M (clade-level carrying capacity) main clade  id == 4 corresponds lambda_S (speciation rate) subclade  id == 5 corresponds mu_S (extinction rate) subclade  id == 6 corresponds t_d (time key innovation) idparsfix ids parameters optimized, e.g. c(1,3,4,6) lambda K optimized, mu. case idparsopt must c(2,5,7). default fix parameters specified idparsopt. idparsnoshift ids parameters shift; can apply ids 4, 5 6, e.g. idparsnoshift = c(4,5) means lambda mu values tshift res sets maximum number species probability must computed, must larger 1 + max(length(brtsM),length(brtsS)) ddmodel sets model diversity-dependence: ddmodel == 1 : linear dependence speciation rate parameter K (= diversity speciation = extinction)ddmodel == 1.3 : linear dependence speciation rate parameter K' (= diversity speciation = 0)ddmodel == 2 : exponential dependence speciation rate parameter K (= diversity speciation = extinction)ddmodel == 2.1 : variant exponential dependence speciation rate offset infinityddmodel == 2.2 : 1/n dependence speciation rateddmodel == 2.3 : exponential dependence speciation rate parameter x (= exponent)ddmodel == 3 : linear dependence extinction rate ddmodel == 4 : exponential dependence extinction rate ddmodel == 4.1 : variant exponential dependence extinction rate offset infinity ddmodel == 4.2 : 1/n dependence extinction rate offset infinity missnumspec number species clade missing phylogeny. One can specify sum missing species main clade subclade vector c(missnumspec_M,missnumspec_S) missing species main clade subclade respectively. cond Conditioning:  cond == 0 : conditioning  cond == 1 : conditioning non-extinction phylogeny soc Sets whether stem crown age used (1 2); stem age works cond = 0 tol Sets tolerances optimization. Consists :  reltolx = relative tolerance parameter values optimization  reltolf = relative tolerance function value optimization  abstolx = absolute tolerance parameter values optimization maxiter Sets maximum number iterations optimization changeloglikifnoconv TRUE loglik set -Inf ML converge optimmethod Method used optimization likelihood. Current default 'subplex'. Alternative 'simplex' (default previous versions) num_cycles number cycles opimization. set Inf, many cycles needed meet tolerance set target function. methode method used ode solver. can either 'analytical' explicit matrix exponentation solvers deSolve package. correction Sets whether correction applied (TRUE) (FALSE) verbose Show parameters loglikelihood every call loglik function","code":""},{"path":"https://rsetienne.github.io/DDD/reference/dd_MS_ML.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Maximization of the loglikelihood under a diversity-dependent diversification model with decoupling of a subclade's diversication dynamics from the main clade's dynamics — dd_MS_ML","text":"lambda_M gives maximum likelihood estimate lambda main clade mu_M gives maximum likelihood estimate mu main clade K_M gives maximum likelihood estimate K main clade lambda_2 gives maximum likelihood estimate lambda subclade mu_S gives maximum likelihood estimate mu subclade t_d gives time key innovation event loglik gives maximum loglikelihood df gives number estimated parameters, .e. degrees feedom conv gives message convergence optimization; conv = 0 means convergence","code":""},{"path":"https://rsetienne.github.io/DDD/reference/dd_MS_ML.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Maximization of the loglikelihood under a diversity-dependent diversification model with decoupling of a subclade's diversication dynamics from the main clade's dynamics — dd_MS_ML","text":"output dataframe containing estimated parameters maximum loglikelihood. computed loglikelihood contains factor q! m!/(q + m)! q number species phylogeny m number missing species, explained supplementary material Etienne et al. 2012.","code":""},{"path":"https://rsetienne.github.io/DDD/reference/dd_MS_ML.html","id":"note","dir":"Reference","previous_headings":"","what":"Note","title":"Maximization of the loglikelihood under a diversity-dependent diversification model with decoupling of a subclade's diversication dynamics from the main clade's dynamics — dd_MS_ML","text":"optimization may get trapped local optima. Try different starting values search global optimum.","code":""},{"path":"https://rsetienne.github.io/DDD/reference/dd_MS_ML.html","id":"references","dir":"Reference","previous_headings":"","what":"References","title":"Maximization of the loglikelihood under a diversity-dependent diversification model with decoupling of a subclade's diversication dynamics from the main clade's dynamics — dd_MS_ML","text":"- Etienne, R.S. et al. 2012, Proc. Roy. Soc. B 279: 1300-1309, doi: 10.1098/rspb.2011.1439  - Etienne, R.S. & B. Haegeman 2012. . Nat. 180: E75-E89, doi: 10.1086/667574","code":""},{"path":[]},{"path":"https://rsetienne.github.io/DDD/reference/dd_MS_ML.html","id":"author","dir":"Reference","previous_headings":"","what":"Author","title":"Maximization of the loglikelihood under a diversity-dependent diversification model with decoupling of a subclade's diversication dynamics from the main clade's dynamics — dd_MS_ML","text":"Rampal S. Etienne & Bart Haegeman","code":""},{"path":"https://rsetienne.github.io/DDD/reference/dd_MS_ML.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Maximization of the loglikelihood under a diversity-dependent diversification model with decoupling of a subclade's diversication dynamics from the main clade's dynamics — dd_MS_ML","text":"","code":"cat(\"This will estimate parameters for two sets of branching times brtsM, brtsS\\n\") #> This will estimate parameters for two sets of branching times brtsM, brtsS cat(\"without conditioning.\\n\") #> without conditioning. cat(\"The tolerance of the optimization is set high so runtime is fast in this example.\\n\") #> The tolerance of the optimization is set high so runtime is fast in this example. cat(\"In real applications, use the default or more stringent settins for tol.\\n\") #> In real applications, use the default or more stringent settins for tol. brtsM = 4:10 brtsS = seq(0.1,3.5,0.7) tsplit = 5 dd_MS_ML(brtsM = brtsM, brtsS = brtsS, tsplit = tsplit, idparsopt = c(1:3,6),           initparsopt = c(0.885, 2e-14, 10, 4.001), idparsfix = NULL, parsfix = NULL,           idparsnoshift = c(4,5), cond = 0, tol = c(3E-1,3E-1,3E-1)) #> You are optimizing la_M mu_M K t_d  #> You are fixing nothing  #> You are not shifting la_S mu_S  #> Optimizing the likelihood - this may take a while.  #> The carrying capacity is lower than the actual number of species. #> The loglikelihood for the initial parameter values is -Inf  #> The initial parameter values have a likelihood that is equal to 0 or below machine precision. Try again with different initial values."},{"path":"https://rsetienne.github.io/DDD/reference/dd_MS_loglik.html","id":null,"dir":"Reference","previous_headings":"","what":"Loglikelihood for macro-evolutionary succession under diversity-dependent diversification with the key innovation at time t = t_d — dd_MS_loglik","title":"Loglikelihood for macro-evolutionary succession under diversity-dependent diversification with the key innovation at time t = t_d — dd_MS_loglik","text":"function computes loglikelihood diversity-dependent diversification model given set branching times parameter values diversity-dependent dynamics innovative subclade different parameters dynamics main clade time t_d, governed carrying capacity experience 's diversity.","code":""},{"path":"https://rsetienne.github.io/DDD/reference/dd_MS_loglik.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Loglikelihood for macro-evolutionary succession under diversity-dependent diversification with the key innovation at time t = t_d — dd_MS_loglik","text":"","code":"dd_MS_loglik(   pars1,   pars2,   brtsM,   brtsS,   missnumspec,   methode = \"odeint::runge_kutta_cash_karp54\" )"},{"path":"https://rsetienne.github.io/DDD/reference/dd_MS_loglik.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Loglikelihood for macro-evolutionary succession under diversity-dependent diversification with the key innovation at time t = t_d — dd_MS_loglik","text":"pars1 Vector parameters: pars1[1] corresponds lambda_M (speciation rate) main clade pars1[2] corresponds mu_M (extinction rate) main clade pars1[3] corresponds K_M (clade-level carrying capacity) main clade pars1[4] corresponds lambda_M (speciation rate) subclade pars1[5] corresponds mu_S (extinction rate) subclade pars1[6] corresponds t_d (time key innovation) pars2 Vector model settings: pars2[1] sets maximum number species probability must computed. must larger 1 + missnumspec + length(brts). pars2[2] sets model diversity-dependence:  - pars2[2] == 1 linear dependence speciation rate parameter K (= diversity speciation = extinction) - pars2[2] == 1.3 linear dependence speciation rate parameter K' (= diversity speciation = 0) - pars2[2] == 2 exponential dependence speciation rate parameter K (= diversity speciation = extinction) - pars2[2] == 2.1 variant exponential dependence speciation rate offset infinity  - pars2[2] == 2.2 1/n dependence speciation rate  - pars2[2] == 2.3 exponential dependence speciation rate parameter x (= exponent) - pars2[2] == 3 linear dependence extinction rate  - pars2[2] == 4 exponential dependence extinction rate  - pars2[2] == 4.1 variant exponential dependence extinction rate offset infinity - pars2[2] == 4.2 1/n dependence extinction ratepars2[3] sets conditioning:  - pars2[3] == 0 conditioning  - pars2[3] == 1 conditioning non-extinction phylogeny pars2[4] sets time splitting branch undergo key innovation leading different parameters pars2[5] sets whether parameters likelihood shown screen (1) (0) pars2[6] sets whether first data point stem age (1) crown age (2) pars2[7] sets whether old (incorrect) likelihood used (0) whether new corrected version used (1) brtsM set branching times main clade phylogeny, positive brtsS set branching times subclade phylogeny, positive missnumspec number species clade missing phylogeny. One can specify sum missing species main clade subclade vector c(missnumspec_M,missnumspec_S) missing species main clade subclade respectively. methode method used solve master equation, default 'analytical' uses matrix exponentiation; alternatively numerical ODE solvers can used, 'odeint::runge_kutta_cash_karp54'. used package version 3.1.","code":""},{"path":"https://rsetienne.github.io/DDD/reference/dd_MS_loglik.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Loglikelihood for macro-evolutionary succession under diversity-dependent diversification with the key innovation at time t = t_d — dd_MS_loglik","text":"loglikelihood","code":""},{"path":"https://rsetienne.github.io/DDD/reference/dd_MS_loglik.html","id":"references","dir":"Reference","previous_headings":"","what":"References","title":"Loglikelihood for macro-evolutionary succession under diversity-dependent diversification with the key innovation at time t = t_d — dd_MS_loglik","text":"- Etienne, R.S. et al. 2012, Proc. Roy. Soc. B 279: 1300-1309, doi: 10.1098/rspb.2011.1439  - Etienne, R.S. & B. Haegeman 2012. . Nat. 180: E75-E89, doi: 10.1086/667574","code":""},{"path":[]},{"path":"https://rsetienne.github.io/DDD/reference/dd_MS_loglik.html","id":"author","dir":"Reference","previous_headings":"","what":"Author","title":"Loglikelihood for macro-evolutionary succession under diversity-dependent diversification with the key innovation at time t = t_d — dd_MS_loglik","text":"Rampal S. Etienne & Bart Haegeman","code":""},{"path":"https://rsetienne.github.io/DDD/reference/dd_MS_loglik.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Loglikelihood for macro-evolutionary succession under diversity-dependent diversification with the key innovation at time t = t_d — dd_MS_loglik","text":"","code":"pars1 = c(0.2,0.1,40,1.0,0.1,9.8) pars2 = c(200,1,0,18.8,1,2) missnumspec = 0 brtsM = c(25.2,24.6,24.0,22.5,21.7,20.4,19.9,19.7,18.8,17.1,15.8,11.8,9.7,8.9,5.7,5.2) brtsS = c(9.6,8.6,7.4,4.9,2.5) dd_MS_loglik(pars1,pars2,brtsM,brtsS,missnumspec) #> This only works for ddmodel = 1.3 or ddmodel == 2.3. #> Parameters: 0.200000 0.100000 40.000000 1.000000 0.100000 9.800000, Loglikelihood: -Inf #> [1] -Inf"},{"path":"https://rsetienne.github.io/DDD/reference/dd_MS_sim.html","id":null,"dir":"Reference","previous_headings":"","what":"Function to simulate the macro-evolutionary succession process assuming diversity-dependent diversification — dd_MS_sim","title":"Function to simulate the macro-evolutionary succession process assuming diversity-dependent diversification — dd_MS_sim","text":"Simulating diversity-dependent diversification process given time new clade emerges different inherent speciation rate extinction rate","code":""},{"path":"https://rsetienne.github.io/DDD/reference/dd_MS_sim.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Function to simulate the macro-evolutionary succession process assuming diversity-dependent diversification — dd_MS_sim","text":"","code":"dd_MS_sim(pars, age, ddmodel = 1.3)"},{"path":"https://rsetienne.github.io/DDD/reference/dd_MS_sim.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Function to simulate the macro-evolutionary succession process assuming diversity-dependent diversification — dd_MS_sim","text":"pars Vector parameters: pars[1] corresponds lambda_M (speciation rate main clade) pars[2] corresponds mu_M (extinction rate main clade) pars[3] corresponds K' (maximum number species proxy case exponential decline speciation rate) pars[4] corresponds lambda_S (speciation rate novel subclade) pars[5] corresponds mu_S (extinction rate) pars[6] tinn, time shift rates occurs lineage leading subclade age Sets crown age simulation ddmodel Sets model diversity-dependence: ddmodel == 1.3 : linear dependence speciation rate parameter K' (= diversity speciation = 0); ddmodel = 1 interpreted model ddmodel == 2.1 : variant exponential dependence speciation rate offset infinity; ddmodel = 2 interpreted model ddmodel == 2.2 : 1/n dependence speciation rateddmodel == 2.3 : exponential dependence speciation rate parameter x (= exponent)","code":""},{"path":"https://rsetienne.github.io/DDD/reference/dd_MS_sim.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Function to simulate the macro-evolutionary succession process assuming diversity-dependent diversification — dd_MS_sim","text":"list following elements: first element tree extant species phylo format  second element tree species, including extinct species, phylo format  third element matrix species  - first column time species born  - second column label parent species; positive negative values indicate whether species belongs left right crown lineage  - third column label daughter species ; positive negative values indicate whether species belongs left right crown lineage  - fourth column time extinction species  fourth element equals -1, species still extant. - fifth column indicates whether species belong main clade (0) subclade (1) fourth element subclade tree extant species (without stem)  fifth element subclade tree species (without stem)  sixth element first, except attributed 0 main clade 1 subclade seventh element Second, except attributed 0 main clade 1 subclade sixth seventh element NULL subclade exist (went extinct).","code":""},{"path":"https://rsetienne.github.io/DDD/reference/dd_MS_sim.html","id":"references","dir":"Reference","previous_headings":"","what":"References","title":"Function to simulate the macro-evolutionary succession process assuming diversity-dependent diversification — dd_MS_sim","text":"- Etienne, R.S. et al. 2012, Proc. Roy. Soc. B 279: 1300-1309, doi: 10.1098/rspb.2011.1439  - Etienne, R.S. & B. Haegeman 2012. . Nat. 180: E75-E89, doi: 10.1086/667574","code":""},{"path":"https://rsetienne.github.io/DDD/reference/dd_MS_sim.html","id":"author","dir":"Reference","previous_headings":"","what":"Author","title":"Function to simulate the macro-evolutionary succession process assuming diversity-dependent diversification — dd_MS_sim","text":"Rampal S. Etienne","code":""},{"path":"https://rsetienne.github.io/DDD/reference/dd_MS_sim.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Function to simulate the macro-evolutionary succession process assuming diversity-dependent diversification — dd_MS_sim","text":"","code":"dd_MS_sim(c(0.2,0.1,20,0.1,0.05,4),10)    #> $tes #>  #> Phylogenetic tree with 4 tips and 3 internal nodes. #>  #> Tip labels: #>   t1, t2, t4, t5 #>  #> Rooted; includes branch lengths. #>  #> $tas #>  #> Phylogenetic tree with 5 tips and 4 internal nodes. #>  #> Tip labels: #>   t1, t3, t2, t4, t5 #>  #> Rooted; includes branch lengths. #>  #> $L #>           [,1] [,2] [,3]      [,4] [,5] #> [1,] 10.000000    0   -1 -1.000000    1 #> [2,] 10.000000   -1    2 -1.000000    0 #> [3,]  4.782674   -1   -3  2.321288    0 #> [4,]  4.297282    2    4 -1.000000    0 #> [5,]  1.066747    4    5 -1.000000    0 #>  #> $tesS #> NULL #>  #> $tasS #> NULL #>  #> $tes2 #>  #> Phylogenetic tree with 4 tips and 3 internal nodes. #>  #> Tip labels: #> [1] \"t1\" \"t2\" \"t4\" \"t5\" #>  #> The tree includes a mapped, 2-state discrete character #> with states: #> \t0, 1 #>  #> Rooted; includes branch lengths. #>  #> $tas2 #>  #> Phylogenetic tree with 5 tips and 4 internal nodes. #>  #> Tip labels: #> [1] \"t1\" \"t3\" \"t2\" \"t4\" \"t5\" #>  #> The tree includes a mapped, 2-state discrete character #> with states: #> \t0, 1 #>  #> Rooted; includes branch lengths. #>"},{"path":"https://rsetienne.github.io/DDD/reference/dd_SR_ML.html","id":null,"dir":"Reference","previous_headings":"","what":"Maximization of the loglikelihood under a diversity-dependent diversification model with a shift in the parameters — dd_SR_ML","title":"Maximization of the loglikelihood under a diversity-dependent diversification model with a shift in the parameters — dd_SR_ML","text":"function computes maximum likelihood estimates parameters diversity-dependent diversification model shifting parameters time t = tshift given set phylogenetic branching times.  also outputs corresponding loglikelihood can used model comparisons.","code":""},{"path":"https://rsetienne.github.io/DDD/reference/dd_SR_ML.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Maximization of the loglikelihood under a diversity-dependent diversification model with a shift in the parameters — dd_SR_ML","text":"","code":"dd_SR_ML(   brts,   initparsopt = c(0.5, 0.1, 2 * (1 + length(brts) + missnumspec), 2 * (1 + length(brts) +     missnumspec), max(brts)/2),   parsfix = NULL,   idparsopt = c(1:3, 6:7),   idparsfix = NULL,   idparsnoshift = (1:7)[c(-idparsopt, (-1)^(length(idparsfix) != 0) * idparsfix)],   res = 10 * (1 + length(brts) + missnumspec),   ddmodel = 1,   missnumspec = 0,   cond = 1,   btorph = 1,   soc = 2,   allbp = FALSE,   tol = c(0.001, 1e-04, 1e-06),   maxiter = 1000 * round((1.25)^length(idparsopt)),   changeloglikifnoconv = FALSE,   optimmethod = \"subplex\",   num_cycles = 1,   methode = \"analytical\",   verbose = FALSE )"},{"path":"https://rsetienne.github.io/DDD/reference/dd_SR_ML.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Maximization of the loglikelihood under a diversity-dependent diversification model with a shift in the parameters — dd_SR_ML","text":"brts set branching times phylogeny, positive initparsopt initial values parameters must optimized parsfix values parameters optimized idparsopt ids parameters must optimized, e.g. 1:7 parameters.  ids defined follows:  id == 1 corresponds lambda (speciation rate) shift  id == 2 corresponds mu (extinction rate) shift  id == 3 corresponds K (clade-level carrying capacity) shift  id == 4 corresponds lambda (speciation rate) shift  id == 5 corresponds mu (extinction rate) shift  id == 6 corresponds K (clade-level carrying capacity) shift  id == 7 corresponds tshift (time shift) idparsfix ids parameters optimized, e.g. c(1,3,4,6) lambda K optimized, mu. case idparsopt must c(2,5,7). default fix parameters specified idparsopt. idparsnoshift ids parameters shift; can apply ids 4, 5 6, e.g. idparsnoshift = c(4,5) means lambda mu values tshift res sets maximum number species probability must computed, must larger 1 + length(brts) ddmodel sets model diversity-dependence:  ddmodel == 1 : linear dependence speciation rate  ddmodel == 2 : exponential dependence speciation rate  ddmodel == 2.1 : variant exponential dependence speciation rate offset infinity ddmodel == 2.2 : 1/n dependence speciation rate ddmodel == 3 : linear dependence extinction rate  ddmodel == 4 : exponential dependence extinction rate ddmodel == 4.1 : variant exponential dependence extinction rate offset infinity ddmodel == 4.2 : 1/n dependence extinction rate offset infinity missnumspec number species clade missing phylogeny cond Conditioning:  cond == 0 : conditioning  cond == 1 : conditioning non-extinction phylogeny  cond == 2 : conditioning non-extinction phylogeny total number extant taxa (including missing species)  cond == 3 : conditioning total number extant taxa (including missing species)  Note: cond == 3 assumes uniform prior stem age, standard constant-rate birth-death models, see e.g. D. Aldous & L. Popovic 2004. Adv. Appl. Prob. 37: 1094-1115 T. Stadler 2009. J. Theor. Biol. 261: 58-66. btorph Sets whether likelihood branching times (0) phylogeny (1) soc Sets whether stem crown age used (1 2) allbp Sets whether search done various initial conditions, tshift branching points (TRUE/FALSE) tol Sets tolerances optimization. Consists :  reltolx = relative tolerance parameter values optimization  reltolf = relative tolerance function value optimization  abstolx = absolute tolerance parameter values optimization maxiter Sets maximum number iterations optimization changeloglikifnoconv TRUE loglik set -Inf ML converge optimmethod Method used optimization likelihood. Current default 'subplex'. Alternative 'simplex' (default previous versions) num_cycles number cycles opimization. set Inf, many cycles needed meet tolerance set target function. methode method used solve master equation, default 'analytical' uses matrix exponentiation; alternatively numerical ODE solvers can used, 'odeint::runge_kutta_cash_karp54'. used package version 3.1. verbose Show parameters loglikelihood every call loglik function","code":""},{"path":"https://rsetienne.github.io/DDD/reference/dd_SR_ML.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Maximization of the loglikelihood under a diversity-dependent diversification model with a shift in the parameters — dd_SR_ML","text":"lambda_1 gives maximum likelihood estimate lambda shift mu_1 gives maximum likelihood estimate mu shift K_1 gives maximum likelihood estimate K shift lambda_2 gives maximum likelihood estimate lambda shift mu_2 gives maximum likelihood estimate mu shift K_2 gives maximum likelihood estimate K shift t_shift gives time shift loglik gives maximum loglikelihood df gives number estimated parameters, .e. degrees feedom conv gives message convergence optimization; conv = 0 means convergence","code":""},{"path":"https://rsetienne.github.io/DDD/reference/dd_SR_ML.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Maximization of the loglikelihood under a diversity-dependent diversification model with a shift in the parameters — dd_SR_ML","text":"output dataframe containing estimated parameters maximum loglikelihood. computed loglikelihood contains factor q! m!/(q + m)! q number species phylogeny m number missing species, explained supplementary material Etienne et al. 2012.","code":""},{"path":"https://rsetienne.github.io/DDD/reference/dd_SR_ML.html","id":"note","dir":"Reference","previous_headings":"","what":"Note","title":"Maximization of the loglikelihood under a diversity-dependent diversification model with a shift in the parameters — dd_SR_ML","text":"optimization may get trapped local optima. Try different starting values search global optimum.","code":""},{"path":"https://rsetienne.github.io/DDD/reference/dd_SR_ML.html","id":"references","dir":"Reference","previous_headings":"","what":"References","title":"Maximization of the loglikelihood under a diversity-dependent diversification model with a shift in the parameters — dd_SR_ML","text":"- Etienne, R.S. et al. 2012, Proc. Roy. Soc. B 279: 1300-1309, doi: 10.1098/rspb.2011.1439  - Etienne, R.S. & B. Haegeman 2012. . Nat. 180: E75-E89, doi: 10.1086/667574","code":""},{"path":[]},{"path":"https://rsetienne.github.io/DDD/reference/dd_SR_ML.html","id":"author","dir":"Reference","previous_headings":"","what":"Author","title":"Maximization of the loglikelihood under a diversity-dependent diversification model with a shift in the parameters — dd_SR_ML","text":"Rampal S. Etienne & Bart Haegeman","code":""},{"path":"https://rsetienne.github.io/DDD/reference/dd_SR_ML.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Maximization of the loglikelihood under a diversity-dependent diversification model with a shift in the parameters — dd_SR_ML","text":"","code":"cat(\"This will estimate parameters for a sets of branching times brts without conditioning.\\n\") #> This will estimate parameters for a sets of branching times brts without conditioning. cat(\"The tolerance of the optimization is set ridiculously high to make runtime fast.\\n\") #> The tolerance of the optimization is set ridiculously high to make runtime fast. cat(\"In real applications, use the default or more stringent settings for tol.\\n\") #> In real applications, use the default or more stringent settings for tol. brts = 1:10 dd_SR_ML(brts = brts, initparsopt = c(0.4581, 1E-6, 17.69, 11.09, 8.9999), idparsopt = c(1:3,6,7),          idparsfix = NULL, parsfix = NULL, idparsnoshift = c(4,5), cond = 0,          tol = c(1E-1,1E-1,1E-1),optimmethod = 'simplex' ) #> You are optimizing la mu K K2 tshift  #> You are fixing nothing  #> You are not shifting la2 mu2  #> Optimizing the likelihood - this may take a while.  #> The loglikelihood for the initial parameter values is -24.52893  #> 1 0.4581 1e-06 17.69 11.09 8.9999 -24.5289252582909 initial  #> Optimization has terminated successfully.  #>  #> Maximum likelihood parameter estimates: 0.458100 0.000001 18.574500 0.458100 0.000001 11.090000 8.999900 #> Maximum loglikelihood: -24.527807 #>"},{"path":"https://rsetienne.github.io/DDD/reference/dd_SR_loglik.html","id":null,"dir":"Reference","previous_headings":"","what":"Loglikelihood for diversity-dependent diversification models with a shift in the parameters at time t = tshift — dd_SR_loglik","title":"Loglikelihood for diversity-dependent diversification models with a shift in the parameters at time t = tshift — dd_SR_loglik","text":"function computes loglikelihood diversity-dependent diversification model given set branching times parameter values parameters allowed shift time t = tshift","code":""},{"path":"https://rsetienne.github.io/DDD/reference/dd_SR_loglik.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Loglikelihood for diversity-dependent diversification models with a shift in the parameters at time t = tshift — dd_SR_loglik","text":"","code":"dd_SR_loglik(pars1, pars2, brts, missnumspec, methode = \"analytical\")"},{"path":"https://rsetienne.github.io/DDD/reference/dd_SR_loglik.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Loglikelihood for diversity-dependent diversification models with a shift in the parameters at time t = tshift — dd_SR_loglik","text":"pars1 Vector parameters: pars1[1] corresponds lambda (speciation rate) shift pars1[2] corresponds mu (extinction rate) shift pars1[3] corresponds K (clade-level carrying capacity) shift pars1[4] corresponds lambda (speciation rate) shift pars1[5] corresponds mu (extinction rate) shift pars1[6] corresponds K (clade-level carrying capacity) shift pars1[7] corresponds tshift (time shift) pars2 Vector model settings: pars2[1] sets maximum number species probability must computed.  must larger 1 + missnumspec + length(brts). pars2[2] sets model diversity-dependence:  - pars2[2] == 1 linear dependence speciation rate parameter K (= diversity speciation = extinction) - pars2[2] == 1.3 linear dependence speciation rate parameter K' (= diversity speciation = 0) - pars2[2] == 2 exponential dependence speciation rate parameter K (= diversity speciation = extinction) - pars2[2] == 2.1 variant exponential dependence speciation rate offset infinity - pars2[2] == 2.2 1/n dependence speciation rate - pars2[2] == 2.3 exponential dependence speciation rate parameter x (= exponent) - pars2[2] == 3 linear dependence extinction rate  - pars2[2] == 4 exponential dependence extinction rate  - pars2[2] == 4.1 variant exponential dependence extinction rate offset infinity - pars2[2] == 4.2 1/n dependence extinction ratepars2[3] sets conditioning:  - pars2[3] == 0 conditioning  - pars2[3] == 1 conditioning non-extinction phylogeny  - pars2[3] == 2 conditioning non-extinction phylogeny total number extant taxa (including missing species) pars2[4] sets whether likelihood branching times (0) phylogeny (1) pars2[5] sets whether parameters likelihood shown screen (1) (0) pars2[6] sets whether first data point stem age (1) crown age (2) brts set branching times phylogeny, positive missnumspec number species clade missing phylogeny methode method used solve master equation, default 'analytical' uses matrix exponentiation; alternatively numerical ODE solvers can used, 'odeint::runge_kutta_cash_karp54'. used package version 3.1.","code":""},{"path":"https://rsetienne.github.io/DDD/reference/dd_SR_loglik.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Loglikelihood for diversity-dependent diversification models with a shift in the parameters at time t = tshift — dd_SR_loglik","text":"loglikelihood","code":""},{"path":"https://rsetienne.github.io/DDD/reference/dd_SR_loglik.html","id":"references","dir":"Reference","previous_headings":"","what":"References","title":"Loglikelihood for diversity-dependent diversification models with a shift in the parameters at time t = tshift — dd_SR_loglik","text":"- Etienne, R.S. et al. 2012, Proc. Roy. Soc. B 279: 1300-1309, doi: 10.1098/rspb.2011.1439  - Etienne, R.S. & B. Haegeman 2012. . Nat. 180: E75-E89, doi: 10.1086/667574","code":""},{"path":[]},{"path":"https://rsetienne.github.io/DDD/reference/dd_SR_loglik.html","id":"author","dir":"Reference","previous_headings":"","what":"Author","title":"Loglikelihood for diversity-dependent diversification models with a shift in the parameters at time t = tshift — dd_SR_loglik","text":"Rampal S. Etienne & Bart Haegeman","code":""},{"path":"https://rsetienne.github.io/DDD/reference/dd_SR_loglik.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Loglikelihood for diversity-dependent diversification models with a shift in the parameters at time t = tshift — dd_SR_loglik","text":"","code":"dd_SR_loglik(pars1 = c(0.2,0.1,50,0.2,0.1,70,5), pars2 = c(100,1,1,1,0,2),    brts = 1:10, missnumspec = 0)  #> [1] -27.37304"},{"path":"https://rsetienne.github.io/DDD/reference/dd_SR_sim.html","id":null,"dir":"Reference","previous_headings":"","what":"Function to simulate the diversity-dependent diversification process with a shift in one or more of the parameters — dd_SR_sim","title":"Function to simulate the diversity-dependent diversification process with a shift in one or more of the parameters — dd_SR_sim","text":"Simulating diversity-dependent diversification process parameter shift certain time","code":""},{"path":"https://rsetienne.github.io/DDD/reference/dd_SR_sim.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Function to simulate the diversity-dependent diversification process with a shift in one or more of the parameters — dd_SR_sim","text":"","code":"dd_SR_sim(pars, age, ddmodel = 1)"},{"path":"https://rsetienne.github.io/DDD/reference/dd_SR_sim.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Function to simulate the diversity-dependent diversification process with a shift in one or more of the parameters — dd_SR_sim","text":"pars Vector parameters: pars[1] corresponds lambda1 (speciation rate rate shift) pars[2] corresponds mu1 (extinction rate rate shift) pars[3] corresponds K1 (clade-level carrying capacity rate shift) pars[4] corresponds lambda2 (speciation rate rate shift) pars[5] corresponds mu2 (extinction rate rate shift) pars[6] corresponds K2 (clade-level carrying capacity rate shift) pars[7] corresponds time shift age Sets crown age simulation ddmodel Sets model diversity-dependence: ddmodel == 1 : linear dependence speciation rate parameter K (= diversity speciation = extinction)ddmodel == 1.3 : linear dependence speciation rate parameter K' (= diversity speciation = 0)ddmodel == 2 : exponential dependence speciation rate parameter K (= diversity speciation = extinction)ddmodel == 2.1 : variant exponential dependence speciation rate offset infinityddmodel == 2.2 : 1/n dependence speciation rateddmodel == 2.3 : exponential dependence speciation rate parameter x (= exponent)ddmodel == 3 : linear dependence extinction rate ddmodel == 4 : exponential dependence extinction rate ddmodel == 4.1 : variant exponential dependence extinction rate offset infinity ddmodel == 4.2 : 1/n dependence extinction rate offset infinity ddmodel == 5 : linear dependence speciation extinction rate","code":""},{"path":"https://rsetienne.github.io/DDD/reference/dd_SR_sim.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Function to simulate the diversity-dependent diversification process with a shift in one or more of the parameters — dd_SR_sim","text":"list following four elements: first element tree extant species phylo format  second element tree species, including extinct species, phylo format  third element matrix species  - first column time species born  - second column label parent species; positive negative values indicate whether species belongs left right crown lineage  - third column label daughter species ; positive negative values indicate whether species belongs left right crown lineage  - fourth column time extinction species equals -1, species still extant. fourth element set branching times tree extant species.","code":""},{"path":"https://rsetienne.github.io/DDD/reference/dd_SR_sim.html","id":"references","dir":"Reference","previous_headings":"","what":"References","title":"Function to simulate the diversity-dependent diversification process with a shift in one or more of the parameters — dd_SR_sim","text":"- Etienne, R.S. et al. 2012, Proc. Roy. Soc. B 279: 1300-1309, doi: 10.1098/rspb.2011.1439  - Etienne, R.S. & B. Haegeman 2012. . Nat. 180: E75-E89, doi: 10.1086/667574","code":""},{"path":"https://rsetienne.github.io/DDD/reference/dd_SR_sim.html","id":"author","dir":"Reference","previous_headings":"","what":"Author","title":"Function to simulate the diversity-dependent diversification process with a shift in one or more of the parameters — dd_SR_sim","text":"Rampal S. Etienne","code":""},{"path":"https://rsetienne.github.io/DDD/reference/dd_SR_sim.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Function to simulate the diversity-dependent diversification process with a shift in one or more of the parameters — dd_SR_sim","text":"","code":"dd_SR_sim(c(0.2,0.1,20,0.2,0.1,40,5),10)  #> $tes #>  #> Phylogenetic tree with 3 tips and 2 internal nodes. #>  #> Tip labels: #>   t1, t4, t5 #>  #> Rooted; includes branch lengths. #>  #> $tas #>  #> Phylogenetic tree with 5 tips and 4 internal nodes. #>  #> Tip labels: #>   t1, t2, t4, t5, t3 #>  #> Rooted; includes branch lengths. #>  #> $L #>           [,1] [,2] [,3]       [,4] #> [1,] 10.000000    0   -1 -1.0000000 #> [2,] 10.000000   -1    2  0.2151096 #> [3,]  2.601500    2    3  1.4590484 #> [4,]  0.789030    2    4 -1.0000000 #> [5,]  0.570331    4    5 -1.0000000 #>  #> $brts #> [1] 10.000000  0.570331 #>"},{"path":"https://rsetienne.github.io/DDD/reference/dd_loglik.html","id":null,"dir":"Reference","previous_headings":"","what":"Loglikelihood for diversity-dependent diversification models — dd_loglik","title":"Loglikelihood for diversity-dependent diversification models — dd_loglik","text":"function computes loglikelihood diversity-dependent diversification model given set branching times parameter values.","code":""},{"path":"https://rsetienne.github.io/DDD/reference/dd_loglik.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Loglikelihood for diversity-dependent diversification models — dd_loglik","text":"","code":"dd_loglik(pars1, pars2, brts, missnumspec, methode = \"analytical\")"},{"path":"https://rsetienne.github.io/DDD/reference/dd_loglik.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Loglikelihood for diversity-dependent diversification models — dd_loglik","text":"pars1 Vector parameters: pars1[1] corresponds lambda (speciation rate) pars1[2] corresponds mu (extinction rate) pars1[3] corresponds K (clade-level carrying capacity) pars2 Vector model settings: pars2[1] sets maximum number species probability must computed.  must larger 1 + missnumspec + length(brts). pars2[2] sets model diversity-dependence:  - pars2[2] == 1 linear dependence speciation rate parameter K (= diversity speciation = extinction)  - pars2[2] == 1.3 linear dependence speciation rate parameter K' (= diversity speciation = 0)  - pars2[2] == 1.4 : positive diversity-dependence speciation rate parameter K' (= diversity speciation rate reaches half maximum); lambda = lambda0 * S/(S + K') S species richness  - pars2[2] == 1.5 : positive negative diversity-dependence speciation rate parameter K' (= diversity speciation = 0); lambda = lambda0 * S/K' * (1 - S/K') S species richness  - pars2[2] == 2 exponential dependence speciation rate parameter K (= diversity speciation = extinction)  - pars2[2] == 2.1 variant exponential dependence speciation rate offset infinity  - pars2[2] == 2.2 1/n dependence speciation rate  - pars2[2] == 2.3 exponential dependence speciation rate parameter x (= exponent)  - pars2[2] == 3 linear dependence extinction rate  - pars2[2] == 4 exponential dependence extinction rate  - pars2[2] == 4.1 variant exponential dependence extinction rate offset infinity  - pars2[2] == 4.2 1/n dependence extinction rate  - pars2[2] == 5 linear dependence speciation extinction rate pars2[3] sets conditioning:  - pars2[3] == 0 conditioning stem crown age  - pars2[3] == 1 conditioning stem crown age non-extinction phylogeny  - pars2[3] == 2 conditioning stem crown age total number extant taxa (including missing species)  - pars2[3] == 3 conditioning total number extant taxa (including missing species) pars2[4] sets whether likelihood branching times (0) phylogeny (1) pars2[5] sets whether parameters likelihood shown screen (1) (0) pars2[6] sets whether first data point stem age (1) crown age (2) brts set branching times phylogeny, positive missnumspec number species clade missing phylogeny methode method used solve master equation, default 'analytical' uses matrix exponentiation; alternatively numerical ODE solvers can used. version 3.1 solvers deSolve package 'lsoda' 'ode45'. Currently solvers odeint used, 'odeint::runge_kutta_cash_karp54', 'odeint::runge_kutta_fehlberg78', 'odeint::runge_kutta_dopri5', odeint::bulirsch_stoer'. first two recommended cases.","code":""},{"path":"https://rsetienne.github.io/DDD/reference/dd_loglik.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Loglikelihood for diversity-dependent diversification models — dd_loglik","text":"loglikelihood","code":""},{"path":"https://rsetienne.github.io/DDD/reference/dd_loglik.html","id":"references","dir":"Reference","previous_headings":"","what":"References","title":"Loglikelihood for diversity-dependent diversification models — dd_loglik","text":"- Etienne, R.S. et al. 2012, Proc. Roy. Soc. B 279: 1300-1309, doi: 10.1098/rspb.2011.1439  - Etienne, R.S. & B. Haegeman 2012. . Nat. 180: E75-E89, doi: 10.1086/667574","code":""},{"path":[]},{"path":"https://rsetienne.github.io/DDD/reference/dd_loglik.html","id":"author","dir":"Reference","previous_headings":"","what":"Author","title":"Loglikelihood for diversity-dependent diversification models — dd_loglik","text":"Rampal S. Etienne & Bart Haegeman","code":""},{"path":"https://rsetienne.github.io/DDD/reference/dd_loglik.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Loglikelihood for diversity-dependent diversification models — dd_loglik","text":"","code":"dd_loglik(pars1 = c(0.5,0.1,100), pars2 = c(100,1,1,1,0,2), brts = 1:10, missnumspec = 0)  #> [1] -34.13958"},{"path":"https://rsetienne.github.io/DDD/reference/dd_multiple_KI_loglik.html","id":null,"dir":"Reference","previous_headings":"","what":"Loglikelihood for diversity-dependent diversification models with multiple decoupling (rate shift) events — dd_multiple_KI_loglik","title":"Loglikelihood for diversity-dependent diversification models with multiple decoupling (rate shift) events — dd_multiple_KI_loglik","text":"function computes loglikelihood diversity-dependent diversification model given set branching times parameter values diversity-dependent dynamics subclades decouple dynamics main clades, potentially accompanied shift parameters.","code":""},{"path":"https://rsetienne.github.io/DDD/reference/dd_multiple_KI_loglik.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Loglikelihood for diversity-dependent diversification models with multiple decoupling (rate shift) events — dd_multiple_KI_loglik","text":"","code":"dd_multiple_KI_loglik(   pars1_list,   pars2,   brts_k_list,   missnumspec_list,   reltol = 1e-14,   abstol = 1e-16,   methode = \"odeint::runge_kutta_cash_karp54\" )"},{"path":"https://rsetienne.github.io/DDD/reference/dd_multiple_KI_loglik.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Loglikelihood for diversity-dependent diversification models with multiple decoupling (rate shift) events — dd_multiple_KI_loglik","text":"pars1_list list paramater sets one rate regime (subclade). parameters : lambda (speciation rate), mu (extinction rate), K (clade-level carrying capacity). pars2 Vector model settings: pars2[1] sets maximum number species probability must computed.  must larger 1 + missnumspec + length(brts). pars2[2] sets model diversity-dependence:  - pars2[2] == 1 linear dependence speciation rate parameter K (= diversity speciation = extinction) - pars2[2] == 1.3 linear dependence speciation rate parameter K' (= diversity speciation = 0) - pars2[2] == 2 exponential dependence speciation rate parameter K (= diversity speciation = extinction) - pars2[2] == 2.1 variant exponential dependence speciation rate offset infinity - pars2[2] == 2.2 1/n dependence speciation rate - pars2[2] == 2.3 exponential dependence speciation rate parameter x (= exponent) - pars2[2] == 3 linear dependence extinction rate  - pars2[2] == 4 exponential dependence extinction rate  - pars2[2] == 4.1 variant exponential dependence extinction rate offset infinity - pars2[2] == 4.2 1/n dependence extinction ratepars2[3] sets conditioning:  - pars2[3] == 0 conditioning (just crown age)  - pars2[3] == 1 conditioning non-extinction phylogeny  - pars2[3] == 2 conditioning number species crown age; yet implemented  - pars2[3] == 3 conditioning number species ; yet implemented  - pars2[3] == 4 conditioning survival subclade  - pars2[3] == 5 conditioning survival subclades crown lineages main clade. assumes subclades already shifted undergo another shift, .e. shifts occur main clade. pars2[4] Obsolete. pars2[5] sets whether parameters likelihood shown screen (1) (0) pars2[6] sets whether first data point stem age (1) crown age (2) pars2[7] sets whether old (incorrect) likelihood used (0), whether new corrected likelihood used (1). brts_k_list list matrices, one rate regime (subclade). matrix first row branching times including shift/decoupling time present time (0) negative time (.e. 10 mya = -10). second row number lineages, .e. starting 2 phylogeny crown increasing one branching time decreasing one decoupling/shift time. last element second last. missnumspec_list list containing number missing species clade. single number m missing species known entire phylogeny, element list 0:m. One can also create m using function create_missnumspec_list reltol relative tolerance integration ODE system, default 1e-14 abstol tolerance tolerance integration ODE system, default 1e-16 methode method used solve master equation, default 'analytical' uses matrix exponentiation; alternatively numerical ODE solvers can used, 'odeint::runge_kutta_cash_karp54'. used package version 3.1.","code":""},{"path":"https://rsetienne.github.io/DDD/reference/dd_sim.html","id":null,"dir":"Reference","previous_headings":"","what":"Function to simulate the diversity-dependent diversification process — dd_sim","title":"Function to simulate the diversity-dependent diversification process — dd_sim","text":"Simulating diversity-dependent diversification process","code":""},{"path":"https://rsetienne.github.io/DDD/reference/dd_sim.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Function to simulate the diversity-dependent diversification process — dd_sim","text":"","code":"dd_sim(pars, age, ddmodel = 1)"},{"path":"https://rsetienne.github.io/DDD/reference/dd_sim.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Function to simulate the diversity-dependent diversification process — dd_sim","text":"pars Vector parameters: pars[1] corresponds lambda (speciation rate) pars[2] corresponds mu (extinction rate) pars[3] corresponds K (clade-level carrying capacity) age Sets crown age simulation ddmodel Sets model diversity-dependence: ddmodel == 1 : linear dependence speciation rate parameter K (= diversity speciation = extinction)ddmodel == 1.3 : linear dependence speciation rate parameter K' (= diversity speciation = 0)ddmodel == 2 : exponential dependence speciation rate parameter K (= diversity speciation = extinction)ddmodel == 2.1 : variant exponential dependence speciation rate offset infinityddmodel == 2.2 : 1/n dependence speciation rateddmodel == 2.3 : exponential dependence speciation rate parameter x (= exponent)ddmodel == 3 : linear dependence extinction rate ddmodel == 4 : exponential dependence extinction rate ddmodel == 4.1 : variant exponential dependence extinction rate offset infinity ddmodel == 4.2 : 1/n dependence extinction rate offset infinity ddmodel == 5 : linear dependence speciation extinction rate","code":""},{"path":"https://rsetienne.github.io/DDD/reference/dd_sim.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Function to simulate the diversity-dependent diversification process — dd_sim","text":"list following four elements: first element tree extant species phylo format  second element tree species, including extinct species, phylo format  third element matrix species  - first column time species born  - second column label parent species; positive negative values indicate whether species belongs left right crown lineage  - third column label daughter species ; positive negative values indicate whether species belongs left right crown lineage  - fourth column time extinction species. equals -1, species still extant. fourth element set branching times tree extant species.","code":""},{"path":"https://rsetienne.github.io/DDD/reference/dd_sim.html","id":"references","dir":"Reference","previous_headings":"","what":"References","title":"Function to simulate the diversity-dependent diversification process — dd_sim","text":"- Etienne, R.S. et al. 2012, Proc. Roy. Soc. B 279: 1300-1309, doi: 10.1098/rspb.2011.1439  - Etienne, R.S. & B. Haegeman 2012. . Nat. 180: E75-E89, doi: 10.1086/667574","code":""},{"path":"https://rsetienne.github.io/DDD/reference/dd_sim.html","id":"author","dir":"Reference","previous_headings":"","what":"Author","title":"Function to simulate the diversity-dependent diversification process — dd_sim","text":"Rampal S. Etienne","code":""},{"path":"https://rsetienne.github.io/DDD/reference/dd_sim.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Function to simulate the diversity-dependent diversification process — dd_sim","text":"","code":"dd_sim(c(0.2,0.1,20),10)  #> $tes #>  #> Phylogenetic tree with 2 tips and 1 internal nodes. #>  #> Tip labels: #>   t1, t2 #>  #> Rooted; includes branch lengths. #>  #> $tas #>  #> Phylogenetic tree with 3 tips and 2 internal nodes. #>  #> Tip labels: #>   t1, t3, t2 #>  #> Rooted; includes branch lengths. #>  #> $L #>           [,1] [,2] [,3]      [,4] #> [1,] 10.000000    0   -1 -1.000000 #> [2,] 10.000000   -1    2 -1.000000 #> [3,]  1.584906   -1   -3  1.241685 #>  #> $brts #> [1] 10 #>"},{"path":"https://rsetienne.github.io/DDD/reference/optimizer.html","id":null,"dir":"Reference","previous_headings":"","what":"Carries out optimization (finding a minimum) — optimizer","title":"Carries out optimization (finding a minimum) — optimizer","text":"wrapper use several optimization routines, currently 'simplex' (method adopted Matlab, 'subplex', R package subplex). function called several packages author.","code":""},{"path":"https://rsetienne.github.io/DDD/reference/optimizer.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Carries out optimization (finding a minimum) — optimizer","text":"","code":"optimizer(   optimmethod = \"simplex\",   optimpars = c(1e-04, 1e-04, 1e-06, 1000),   num_cycles = 1,   fun,   trparsopt,   jitter = 0,   ... )"},{"path":"https://rsetienne.github.io/DDD/reference/optimizer.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Carries out optimization (finding a minimum) — optimizer","text":"optimmethod method use optimization, either 'simplex' 'subplex' optimpars Parameters optimization: relative tolerance function arguments, relative tolerance function value, absolute tolerance function arguments well function value, maximum number iterations num_cycles Number cycles optimization. set Inf, optimization repeated result , within tolerance, equal starting values, maximum 10 cycles. fun Function optimized trparsopt Initial guess parameters optimized jitter Perturbation initial parameter value precisely equal 0.5; relevant subplex chosen. default value 0, jitter applied. recommended value using 1E-5. ... arguments function optimimzed, settings optimization routine","code":""},{"path":"https://rsetienne.github.io/DDD/reference/optimizer.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Carries out optimization (finding a minimum) — optimizer","text":"list containing optimal function arguments (par, optimal function value (fvalues) whether optimization converged (conv) .","code":""},{"path":"https://rsetienne.github.io/DDD/reference/optimizer.html","id":"author","dir":"Reference","previous_headings":"","what":"Author","title":"Carries out optimization (finding a minimum) — optimizer","text":"Rampal S. Etienne","code":""},{"path":"https://rsetienne.github.io/DDD/reference/optimizer.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Carries out optimization (finding a minimum) — optimizer","text":"","code":"cat(\"No examples\") #> No examples"},{"path":"https://rsetienne.github.io/DDD/reference/phylo2L.html","id":null,"dir":"Reference","previous_headings":"","what":"Function to convert phylogeny to a table with speciation and extinction events — phylo2L","title":"Function to convert phylogeny to a table with speciation and extinction events — phylo2L","text":"Converting phylogeny table speciation extinction events","code":""},{"path":"https://rsetienne.github.io/DDD/reference/phylo2L.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Function to convert phylogeny to a table with speciation and extinction events — phylo2L","text":"","code":"phylo2L(phy)"},{"path":"https://rsetienne.github.io/DDD/reference/phylo2L.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Function to convert phylogeny to a table with speciation and extinction events — phylo2L","text":"phy phylogeny phylo type","code":""},{"path":"https://rsetienne.github.io/DDD/reference/phylo2L.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Function to convert phylogeny to a table with speciation and extinction events — phylo2L","text":"L Matrix events produced dd_sim:  - first column time species born Mya - second column label parent species; positive negative values indicate whether species belongs left right crown lineage  - third column label daughter species ; positive negative values indicate whether species belongs left right crown lineage  - fourth column time extinction species; fourth element equals -1, species still extant.","code":""},{"path":"https://rsetienne.github.io/DDD/reference/phylo2L.html","id":"references","dir":"Reference","previous_headings":"","what":"References","title":"Function to convert phylogeny to a table with speciation and extinction events — phylo2L","text":"- Etienne, R.S. et al. 2012, Proc. Roy. Soc. B 279: 1300-1309, doi: 10.1098/rspb.2011.1439  - Etienne, R.S. & B. Haegeman 2012. . Nat. 180: E75-E89, doi: 10.1086/667574","code":""},{"path":"https://rsetienne.github.io/DDD/reference/phylo2L.html","id":"author","dir":"Reference","previous_headings":"","what":"Author","title":"Function to convert phylogeny to a table with speciation and extinction events — phylo2L","text":"Liang Xu","code":""},{"path":"https://rsetienne.github.io/DDD/reference/phylo2L.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Function to convert phylogeny to a table with speciation and extinction events — phylo2L","text":"","code":"sim = dd_sim(c(0.2,0.1,20),10) phy = sim$tas L = phylo2L(phy) phy2 = L2phylo(L, dropextinct = FALSE) graphics::par(mfrow = c(1,3)) graphics::plot(phy) graphics::plot(phy2) graphics::plot(L2phylo(sim$L, dropextinct = FALSE))"},{"path":"https://rsetienne.github.io/DDD/reference/rng_respecting_sample.html","id":null,"dir":"Reference","previous_headings":"","what":"Sampling in which zero probabilities are removed — rng_respecting_sample","title":"Sampling in which zero probabilities are removed — rng_respecting_sample","text":"Sampling zero probabilities removed","code":""},{"path":"https://rsetienne.github.io/DDD/reference/rng_respecting_sample.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Sampling in which zero probabilities are removed — rng_respecting_sample","text":"","code":"rng_respecting_sample(x, size, replace, prob)"},{"path":"https://rsetienne.github.io/DDD/reference/rng_respecting_sample.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Sampling in which zero probabilities are removed — rng_respecting_sample","text":"x either vector one elements choose,     positive integer.  See ‘Details.’ size non-negative integer giving number items choose. replace sampling replacement? prob vector probability weights obtaining elements     vector sampled.","code":""},{"path":"https://rsetienne.github.io/DDD/reference/rng_respecting_sample.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Sampling in which zero probabilities are removed — rng_respecting_sample","text":"vector length size elements drawn   either x integers 1:x.","code":""},{"path":"https://rsetienne.github.io/DDD/reference/rng_respecting_sample.html","id":"note","dir":"Reference","previous_headings":"","what":"Note","title":"Sampling in which zero probabilities are removed — rng_respecting_sample","text":"thanks Pedro Neves finding feature base::sample","code":""},{"path":[]},{"path":"https://rsetienne.github.io/DDD/reference/rng_respecting_sample.html","id":"author","dir":"Reference","previous_headings":"","what":"Author","title":"Sampling in which zero probabilities are removed — rng_respecting_sample","text":"Richel J.C. Bilderbeek","code":""},{"path":"https://rsetienne.github.io/DDD/reference/rng_respecting_sample.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Sampling in which zero probabilities are removed — rng_respecting_sample","text":"","code":"# Number of draws   n <- 1000      # Do normal sampling   set.seed(42)   draws_1 <- DDD:::rng_respecting_sample(     1:3, size = n, replace = TRUE, prob = c(1.0, 1.0, 1.0)   )      # Do a sampling with one element of probability zero   set.seed(42)   draws_2 <- DDD:::rng_respecting_sample(     1:4, size = n, replace = TRUE, prob = c(1.0, 1.0, 1.0, 0.0)   )   testit::assert(sum(draws_2 == 4) == 0)   testit::assert(draws_1 == draws_2)      # Use base sampling will give different results,   # as it results in different RNG values   set.seed(42)   draws_3 <- sample(     1:4, size = n, replace = TRUE, prob = c(1.0, 1.0, 1.0, 0.0)   )   testit::assert(sum(draws_3 == 4) == 0)   testit::assert(!all(draws_1 == draws_3))"},{"path":"https://rsetienne.github.io/DDD/reference/roundn.html","id":null,"dir":"Reference","previous_headings":"","what":"Rounds up in the usual manner — roundn","title":"Rounds up in the usual manner — roundn","text":"standard round function R rounds x.5 nearest even integer. odd behavior corrected roundn","code":""},{"path":"https://rsetienne.github.io/DDD/reference/roundn.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Rounds up in the usual manner — roundn","text":"","code":"roundn(x, digits = 0)"},{"path":"https://rsetienne.github.io/DDD/reference/roundn.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Rounds up in the usual manner — roundn","text":"x Number rounded digits Sets number decimals rounding.","code":""},{"path":"https://rsetienne.github.io/DDD/reference/roundn.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Rounds up in the usual manner — roundn","text":"n number","code":""},{"path":"https://rsetienne.github.io/DDD/reference/roundn.html","id":"author","dir":"Reference","previous_headings":"","what":"Author","title":"Rounds up in the usual manner — roundn","text":"Rampal S. Etienne","code":""},{"path":"https://rsetienne.github.io/DDD/reference/roundn.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Rounds up in the usual manner — roundn","text":"","code":"round(2.5) #> [1] 2 roundn(2.5) #> [1] 3 round(3.5) #> [1] 4 roundn(3.5) #> [1] 4 round(2.65,digits = 1) #> [1] 2.6 roundn(2.65,digits = 1) #> [1] 2.7 round(2.75,digits = 1) #> [1] 2.8 roundn(2.75,digits = 1) #> [1] 2.8"},{"path":"https://rsetienne.github.io/DDD/reference/sample2.html","id":null,"dir":"Reference","previous_headings":"","what":"Takes samples in the usual manner — sample2","title":"Takes samples in the usual manner — sample2","text":"standard sample function R samples n numbers x = n. unwanted behavior size vector sample changes dynamically. corrected sample2","code":""},{"path":"https://rsetienne.github.io/DDD/reference/sample2.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Takes samples in the usual manner — sample2","text":"","code":"sample2(x, size, replace = FALSE, prob = NULL)"},{"path":"https://rsetienne.github.io/DDD/reference/sample2.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Takes samples in the usual manner — sample2","text":"x vector one elements size non-negative integer giving number items choose. replace sampling replacement? prob vector probability weights obtaining elements vector sampled.","code":""},{"path":"https://rsetienne.github.io/DDD/reference/sample2.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Takes samples in the usual manner — sample2","text":"sam vector length size sampled x.","code":""},{"path":"https://rsetienne.github.io/DDD/reference/sample2.html","id":"author","dir":"Reference","previous_headings":"","what":"Author","title":"Takes samples in the usual manner — sample2","text":"Rampal S. Etienne","code":""},{"path":"https://rsetienne.github.io/DDD/reference/sample2.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Takes samples in the usual manner — sample2","text":"","code":"sample(x = 10,size = 5,replace = TRUE) #> [1] 10  1  2  4  1 sample2(x = 10,size = 5,replace = TRUE) #> [1] 10 10 10 10 10"},{"path":"https://rsetienne.github.io/DDD/reference/simplex.html","id":null,"dir":"Reference","previous_headings":"","what":"Carries out optimization using a simplex algorithm (finding a minimum) — simplex","title":"Carries out optimization using a simplex algorithm (finding a minimum) — simplex","text":"Function optimize target function using simplex method adopted Matlab","code":""},{"path":"https://rsetienne.github.io/DDD/reference/simplex.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Carries out optimization using a simplex algorithm (finding a minimum) — simplex","text":"","code":"simplex(fun, trparsopt, optimpars, ...)"},{"path":"https://rsetienne.github.io/DDD/reference/simplex.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Carries out optimization using a simplex algorithm (finding a minimum) — simplex","text":"fun Function optimized trparsopt Initial guess parameters optimized optimpars Parameters optimization: relative tolerance function arguments, relative tolerance function value, absolute tolerance function arguments, maximum number iterations ... arguments function optimimzed, settings optimization routine","code":""},{"path":"https://rsetienne.github.io/DDD/reference/simplex.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Carries out optimization using a simplex algorithm (finding a minimum) — simplex","text":"list containing optimal function arguments (par, optimal function value (fvalues) whether optimization converged (conv) .","code":""},{"path":"https://rsetienne.github.io/DDD/reference/simplex.html","id":"author","dir":"Reference","previous_headings":"","what":"Author","title":"Carries out optimization using a simplex algorithm (finding a minimum) — simplex","text":"Rampal S. Etienne","code":""},{"path":"https://rsetienne.github.io/DDD/reference/simplex.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Carries out optimization using a simplex algorithm (finding a minimum) — simplex","text":"","code":"cat(\"No examples\") #> No examples"},{"path":"https://rsetienne.github.io/DDD/reference/td_sim.html","id":null,"dir":"Reference","previous_headings":"","what":"Simulation of a diversity-dependent-like time-dependent process — td_sim","title":"Simulation of a diversity-dependent-like time-dependent process — td_sim","text":"Simulates phylogenetic tree branching according time-dependent process calibrated expected number species diversity-dependent process time.","code":""},{"path":"https://rsetienne.github.io/DDD/reference/td_sim.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Simulation of a diversity-dependent-like time-dependent process — td_sim","text":"","code":"td_sim(pars, age, ddmodel = 1, methode = \"ode45\")"},{"path":"https://rsetienne.github.io/DDD/reference/td_sim.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Simulation of a diversity-dependent-like time-dependent process — td_sim","text":"pars Vector parameters: pars[1] corresponds lambda0 (speciation rate) pars[2] corresponds mu0 (extinction rate) pars[3] corresponds lambda1 (decline parameter speciation rate) K diversity-dependence-like models pars[4] corresponds mu1 (decline parameter extinction rate) age crown age tree simulate, .e. simulation time. ddmodel diversity-dependent model used reference time-dependent model. methode method used solve master equation. See deSolve::ode() documentation possible inputs","code":""},{"path":"https://rsetienne.github.io/DDD/reference/td_sim.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Simulation of a diversity-dependent-like time-dependent process — td_sim","text":"list following four elements: first element tree extant species phylo format  second element tree species, including extinct species, phylo format  third element matrix species - first column time species born  - second column label parent species; positive negative values indicate whether species belongs left right crown lineage  - third column label daughter species ; positive negative values indicate whether species belongs left right crown lineage  - fourth column time extinction species. equals -1, species still extant.","code":""},{"path":"https://rsetienne.github.io/DDD/reference/td_sim.html","id":"author","dir":"Reference","previous_headings":"","what":"Author","title":"Simulation of a diversity-dependent-like time-dependent process — td_sim","text":"César Martinez, Rampal S. Etienne","code":""},{"path":"https://rsetienne.github.io/DDD/reference/transform_pars.html","id":null,"dir":"Reference","previous_headings":"","what":"Transforming parameters from -Inf to Inf into parameters from -1 to 1 — transform_pars","title":"Transforming parameters from -Inf to Inf into parameters from -1 to 1 — transform_pars","text":"Function transform pars way useful optimization: trpars <- sign(pars) * pars/(sign(pars) + pars);","code":""},{"path":"https://rsetienne.github.io/DDD/reference/transform_pars.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Transforming parameters from -Inf to Inf into parameters from -1 to 1 — transform_pars","text":"","code":"transform_pars(pars)"},{"path":"https://rsetienne.github.io/DDD/reference/transform_pars.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Transforming parameters from -Inf to Inf into parameters from -1 to 1 — transform_pars","text":"pars Parameters transformed","code":""},{"path":"https://rsetienne.github.io/DDD/reference/transform_pars.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Transforming parameters from -Inf to Inf into parameters from -1 to 1 — transform_pars","text":"Transformed parameters","code":""},{"path":"https://rsetienne.github.io/DDD/reference/transform_pars.html","id":"author","dir":"Reference","previous_headings":"","what":"Author","title":"Transforming parameters from -Inf to Inf into parameters from -1 to 1 — transform_pars","text":"Rampal S. Etienne","code":""},{"path":"https://rsetienne.github.io/DDD/reference/untransform_pars.html","id":null,"dir":"Reference","previous_headings":"","what":"Untransforming parameters from -1 to 1 into parameters from -Inf to Inf. — untransform_pars","title":"Untransforming parameters from -1 to 1 into parameters from -Inf to Inf. — untransform_pars","text":"Function untransform pars optimization: pars <- sign(trpars) * trpars/(sign(trpars) - trpars);","code":""},{"path":"https://rsetienne.github.io/DDD/reference/untransform_pars.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Untransforming parameters from -1 to 1 into parameters from -Inf to Inf. — untransform_pars","text":"","code":"untransform_pars(trpars)"},{"path":"https://rsetienne.github.io/DDD/reference/untransform_pars.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Untransforming parameters from -1 to 1 into parameters from -Inf to Inf. — untransform_pars","text":"trpars Parameters untransformed","code":""},{"path":"https://rsetienne.github.io/DDD/reference/untransform_pars.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Untransforming parameters from -1 to 1 into parameters from -Inf to Inf. — untransform_pars","text":"Untransformed parameters","code":""},{"path":"https://rsetienne.github.io/DDD/reference/untransform_pars.html","id":"author","dir":"Reference","previous_headings":"","what":"Author","title":"Untransforming parameters from -1 to 1 into parameters from -Inf to Inf. — untransform_pars","text":"Rampal S. Etienne","code":""}]
